!function(){"use strict";angular.module("app.components",["oauth","leaflet-directive","restangular"])}(),function(){"use strict";function t(t,e,n){function s(t){var e={kitName:t.device.name,kitType:o(t),kitLastTime:moment(c(t)).fromNow(),kitLocation:a(t),kitLabels:i(t),kitClass:r(o(t))};return e}function a(t){var e="",n=t.data.location.city,s=t.data.location.country;return n&&(e+=n),s&&(e+=", "+s),e}function i(t){return{status:t.status,exposure:t.data.location.exposure}}function o(t){var e;return new RegExp("sck","i").test(t.kit.name)&&(e="SmartCitizen Kit"),e}function r(t){return t?t.toLowerCase().split(" ").join("_"):""}function c(t){return t.updated_at}function l(t){return moment(t.recorded_at).format("")}function d(t){return moment(t).format("YYYY-MM-DDThh:mm:ss")+"Z"}function u(s){var a=n.defer(),i=0,o=[];return s.forEach(function(n,r){t.getDevice(n).then(function(t){o[r]=new e(t,{type:"preview"}),i++,s.length===i&&a.resolve(o)})}),a.promise}var m={parseKit:s,parseKitTime:c,parseSensorTime:l,convertTime:d,getOwnerKits:u};return m}angular.module("app.components").factory("utils",t),t.$inject=["device","Kit","$q"]}(),function(){"use strict";function t(t,e,n){function s(){a()}function a(){var t=_.pluck(c.kits,"id");e.getOwnerKits(t).then(function(t){o=t,r.kits=t,console.log("k",o)})}function i(t){"all"===t&&(t=void 0),r.status=t}var o,r=this,c=new t(n);r.status=void 0,r.user=c,r.kits,r.filteredKits,r.dropdownSelected,r.dropdownOptions=[{text:"SET UP",value:"1"},{text:"EDIT",value:"2"}],r.filterKits=i,s()}function e(){return function(){return console.log("kk.",kits),kits?kits.filter(function(){return filter.labels.status===vm.status}):void 0}}angular.module("app.components").controller("UserProfileController",t).filter("filterByStatus",e),t.$inject=["User","utils","userData"]}(),function(){"use strict";function t(){return{scope:{show:"="},restrict:"A",controller:"SignupController",controllerAs:"vm",templateUrl:"app/components/signup/signup.html"}}angular.module("app.components").directive("signup",t)}(),function(){"use strict";function t(t,e,n,s,a){function i(){e.show({hasBackdrop:!0,controller:"SignupDialogController",templateUrl:"app/components/signup/signupModal.html",clickOutsideToClose:!0}).then(function(){})["finally"](function(){})}function o(t){n.createUser(t).then(function(){a.success("Signup was successful")})["catch"](function(t){console.log("err",t.data.errors)})}var r=this;r.showSignup=i,r.signup=o,r.errors={}}angular.module("app.components").controller("SignupController",t),t.$inject=["$scope","$mdDialog","user","animation","alert"]}(),function(){"use strict";function t(){function t(){}return{link:t,scope:!0,restrict:"E",templateUrl:"app/components/search/search.html",controller:"SearchController",controllerAs:"vm"}}angular.module("app.components").directive("search",t)}(),function(){"use strict";function t(t,e){function n(){}function s(){}function a(t){return e.globalSearch(t).then(function(t){return 0===t.length?(angular.element(document.body).css("overflow","auto"),t):(angular.element(document.body).css("overflow","hidden"),t.map(function(t){if("Location"!==t.type){var e=i(t),n=o(t);return{type:t.type,name:n,location:e,image:"User"===t.type?"./assets/images/avatar.svg":"./assets/images/kit.svg"}}}))})}function i(t){var e="";return t.city&&(e+=t.city),t.country&&(e+=", "+t.country),e}function o(t){var e="User"===t.type?t.username:t.name;return e?e:"No name"}var r=this;r.searchTextChange=n,r.selectedItemChange=s,r.querySearch=a,r.isIconWhite=!0,t.$on("removeNav",function(){t.$apply(function(){r.isIconWhite=!1})}),t.$on("addNav",function(){t.$apply(function(){r.isIconWhite=!0})})}angular.module("app.components").controller("SearchController",t),t.$inject=["$scope","search"]}(),function(){"use strict";function t(){function t(){}return{link:t,scope:!0,restrict:"E",templateUrl:"app/components/navbar/navbar.html",controller:"NavbarController",controllerAs:"vm"}}angular.module("app.components").directive("navbar",t)}(),function(){"use strict";function t(t,e){function n(){e.logout(),s.isLoggedin=!1}var s=this;s.isShown=!0,s.isLoggedin=!1,s.logout=n,s.dropdownOptions=[{divider:!0,text:"Hello,           "},{text:"PROFILE",value:"1"},{text:"LOGOUT",value:"2"}],s.dropdownSelected,t.$on("removeNav",function(){t.$apply(function(){s.isShown=!1})}),t.$on("addNav",function(){t.$apply(function(){s.isShown=!0})}),t.$on("loggedIn",function(){s.isLoggedin=!0,s.currentUser=e.getCurrentUser().data,s.dropdownOptions[0].text="Hello, "+s.currentUser.username})}angular.module("app.components").controller("NavbarController",t),t.$inject=["$scope","auth"]}(),function(){"use strict";function t(t,e,n,s,a){function i(t){s.updateUser(t).then(function(){console.log("done")})}function o(){s.removeUser().then(function(){console.log("removed")})}function r(){}var c=this;e&&(c.user=new n(e)),c.kits,c.status=void 0,c.formUser={avatar:null},c.dropdownSelected,c.dropdownOptions=[{text:"SET UP",value:"1"},{text:"EDIT",value:"2"}],c.filterKits=r,c.updateUser=i,c.removeUser=o,t.$on("loggedIn",function(){c.user=a.getCurrentUser().data,_.defaults(c.formUser,c.user)})}angular.module("app.components").controller("MyProfileController",t),t.$inject=["$scope","authUser","User","user","auth"]}(),function(){"use strict";angular.module("app.components")}(),function(){"use strict";function t(t,e,n,s,a,i,o){function r(t){return t.map(function(t){return c(t,!1)})}function c(t){return t.icon="offline"===t.status?u.icons.smartCitizenOffline:u.icons.smartCitizenOnline,t}function l(){var t={defaultIcon:{},smartCitizenNormal:{type:"div",className:"marker_normal",iconSize:[12,12]},smartCitizenOnline:{type:"div",className:"marker_online",iconSize:[12,12]},smartCitizenOffline:{type:"div",className:"marker_offline",iconSize:[12,12]}};return t}function d(t){return t}var u=this,m=d(a[0]);u.icons=l(),u.tiles={url:"https://a.tiles.mapbox.com/v4/tomasdiez.jnbhcnb2/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoidG9tYXNkaWV6IiwiYSI6ImRTd01HSGsifQ.loQdtLNQ8GJkJl2LUzzxVg"},u.center={lat:m.lat,lng:m.lng,zoom:12},u.markers=r(a),u.currentMarker=o.getCurrentMarker(),u.defaults={scrollWheelZoom:!1},u.events={map:{enable:["dragend","zoomend","moveend","popupopen","popupclose","mousedown","dblclick","click","touchstart"],logic:"broadcast"}},t.$on("leafletDirectiveMap.popupopen",function(t,n){u.center={lat:n.leafletEvent.popup._latlng.lat,lng:n.leafletEvent.popup._latlng.lng,zoom:n.model.center.zoom};n.leafletEvent.popup._source.options.myData.id;e.go("home.kit",{id:1616})})}angular.module("app.components").controller("MapController",t),t.$inject=["$scope","$state","$timeout","location","initialMarkers","device","marker"]}(),function(){"use strict";function t(){return{scope:{show:"="},restrict:"A",controller:"LoginController",controllerAs:"vm",templateUrl:"app/components/login/login.html"}}angular.module("app.components").directive("login",t)}(),function(){"use strict";function t(t,e){function n(){e.show({hasBackdrop:!0,controller:"LoginDialogController",templateUrl:"app/components/login/loginModal.html",clickOutsideToClose:!0}).then(function(){})["finally"](function(){})}t.showLogin=n}angular.module("app.components").controller("LoginController",t),t.$inject=["$scope","$mdDialog","auth","alert"]}(),function(){"use strict";function t(){}angular.module("app.components").controller("HomeController",t)}(),function(){"use strict";function t(t,e,n,s,a,i){function o(){var t=P.kit.owner.kits;s.getOwnerKits(t).then(function(t){P.ownerKits=t})}function r(t){return t.time=moment(s.parseKitTime(t)).fromNow(),t}function c(t){var e=angular.element(".sensors_container"),n=e.scrollLeft(),s=20;console.log("scroll",n),"left"===t?e.scrollLeft(n+s):"right"===t&&e.scrollLeft(n-s)}function l(){return P.sensorsToCompare.filter(function(t){return t.id!==P.selectedSensor})}function d(t,e,n){if(e[0]){if(!T){if(t="date",!n)var n={};n.from=C.getValuePickerFrom(),n.to=C.getValuePickerTo()}"date"===t?(P.loadingChart=!0,u(n.from,n.to).then(function(){P.chartDataMain=m(e)})):"sensor"===t&&(P.chartDataMain=m(e))}}function u(t,n){var s=e.id;return a.getSensorsData(s,t,n).then(function(t){T=t.readings})}function m(t){var e=p(T,t[0]),n={data:e,color:P.selectedSensorData.color,unit:P.selectedSensorData.unit};if(t[1]&&-1!==t[1])var s=p(T,t[1]),a={data:s,color:P.selectedSensorToCompareData.color,unit:P.selectedSensorToCompareData.unit};var i=[n,a];return i}function p(t,e){return 0===t.length?[]:t.map(function(t){var n=t&&t.timestamp,s=t&&t.data[e];return s=null===s?0:s,{time:n,data:s}})}function v(t){var e=t.value;void 0!==e&&("main"===t.type?x=e:"compare"===t.type&&(S=e))}function g(){var t=angular.element(".sensor_icon_selected"),e=t.find(".container_parent");e.css("fill",P.selectedSensorData.color)}function f(){var t=angular.element(".sensor_compare").find("md-select-label").find("span");t.css("color",P.selectedSensorToCompareData.color||"white");var e=angular.element(".sensor_compare").find("md-select-label").find(".md-select-icon");e.css("color","white")}function _(){var t=angular.element(".chart_move_left").find("svg");t.find(".fill_container").css("fill","#03252D");var t=angular.element(".chart_move_right").find("svg");t.find(".fill_container").css("fill","#4E656B")}function h(){var t=angular.element(".kit_time_icon");t.find(".stroke_container").css({"stroke-width":"0.5px",stroke:"#A4B0B3"}),t.find(".fill_container").css("fill","#A4B0B3")}function k(t){return new Date(t).getTime()}function b(){return k(C.getValuePickerTo())-k(C.getValuePickerFrom())}function y(t){var e=b();if("left"===t){var n=C.getValuePickerFrom(),s=k(C.getValuePickerFrom())-e;C.setValuePickers([s,n])}else if("right"===t){var n=k(C.getValuePickerTo())+e,s=C.getValuePickerTo();C.setValuePickers([s,n])}}function w(){function t(){return k(new Date)}function e(){return k(t()-6048e5)}var n,s=$("#picker_from").pickadate({container:"body",klass:{holder:"picker__holder picker_container"}}),a=s.pickadate("picker"),i=$("#picker_to").pickadate({container:"body",klass:{holder:"picker__holder picker_container"}}),o=i.pickadate("picker");return a.get("value")&&o.set("min",a.get("select")),o.get("value")&&a.set("max",o.get("select")),a.on("set",function(t){t.select?(o.get("value")&&"single"===n&&d("date",[x,S],{from:a.get("value"),to:o.get("value")}),o.set("min",a.get("select"))):"clear"in t&&o.set("min",!1)}),o.on("set",function(t){t.select?(a.get("value")&&d("date",[x,S],{from:a.get("value"),to:o.get("value")}),a.set("max",o.get("select"))):"clear"in t&&a.set("max",!1)}),o.set("max",new Date),a.set("select",e()),o.set("select",t()),{getValuePickerFrom:function(){return a.get("value")},setValuePickerFrom:function(t){n="single",a.set("select",t)},getValuePickerTo:function(){return o.get("value")},setValuePickerTo:function(t){n="single",o.set("select",t)},setValuePickers:function(t){var e=t[0],s=t[1];n="pair",a.set("select",e),o.set("select",s)}}}var x,S,T,P=this,C=w();P.marker=r(n),P.kit=new i(n);var L=P.kit.getSensors({type:"main"});P.battery=L[1],P.sensors=L[0],P.sensorsToCompare=P.kit.getSensors({type:"compare"}),P.slide=c,P.chartData,P.selectedSensor=P.sensors[0].id,P.selectedSensorData={icon:P.sensors[0].icon,value:P.sensors[0].value,unit:P.sensors[0].unit,color:P.sensors[0].color},P.selectedSensorToCompare,P.selectedSensorToCompareData,P.moveChart=y,P.loadingChart=!1,P.dropdownOptions=[{text:"SET UP",value:"1"},{text:"EDIT",value:"2"}],P.dropdownSelected,t.$watch("vm.selectedSensor",function(t){P.selectedSensorToCompare=void 0,P.selectedSensorToCompareData={},P.chartDataCompare=[],S=void 0,P.sensors.forEach(function(e){e.id===t&&(P.selectedSensorData={icon:e.icon,value:e.value,unit:e.unit,color:e.color})}),P.sensorsToCompare=l(),setTimeout(function(){g(),f(),v({type:"main",value:t}),d("sensor",[x,S])},100)}),t.$watch("vm.selectedSensorToCompare",function(t){P.sensorsToCompare.forEach(function(e){e.id===t&&(P.selectedSensorToCompareData={icon:e.icon,color:e.color,unit:e.unit})}),setTimeout(function(){f(),v({type:"compare",value:t}),d("sensor",[x,S])},100)}),t.$on("hideSpinner",function(){P.loadingChart=!1}),setTimeout(function(){g(),_(),h(),o()},1e3)}angular.module("app.components").controller("KitController",t),t.$inject=["$scope","$stateParams","marker","utils","sensor","Kit","$mdDialog"]}(),function(){"use strict";function t(t,e,n,s){t.answer=function(a){n.post(a).then(function(t){console.log("data",t),s.success("Signup was successful"),e.hide()})["catch"](function(e){console.log("err",e.data.errors),t.errors=e.data.errors})},t.hide=function(){e.hide()},t.cancel=function(){e.cancel()}}angular.module("app.components").controller("SignupDialogController",t),t.$inject=["$scope","$mdDialog","user","alert"]}(),function(){"use strict";function t(t,e,n,s){t.answer=function(a){n.login(a).then(function(t){console.log("yes",t);var a=t.access_token;n.saveToken(a),s.success("Signup was successful"),e.hide()})["catch"](function(e){console.log("no"),console.log("err",e.data.errors),t.errors=e.data.errors})},t.hide=function(){e.hide()},t.cancel=function(){e.cancel()}}angular.module("app.components").controller("LoginDialogController",t),t.$inject=["$scope","$mdDialog","auth","alert"]}(),function(){"use strict";angular.module("app.components").factory("User",function(){function t(t,e){e&&"authUser"===e.type?(this.username=t.username,this.avatar=t.avatar||"./assets/images/user_details_icon.svg",this.kits=t.devices,this.city=t.location.city||"No city",this.country=t.location.country||"No country",this.location=t.location.city&&t.location.country?t.location.city+", "+t.location.country:"Barcelona, Spain",this.url=t.url||"http://example.com",this.email=t.email||"no email",this.key="",this.macAddress=""):(this.username=t.username,this.avatar=t.avatar||"./assets/images/user_details_icon.svg",this.kits=t.devices,this.location=t.location.city&&t.location.country?t.location.city+", "+t.location.country:"Barcelona, Spain",this.url=t.url||"http://example.com")}return t})}(),function(){"use strict";function t(t){var e,n=t.name,s=t.description;return e=new RegExp("custom circuit","i").test(s)?n:new RegExp("noise","i").test(s)?"SOUND":new RegExp("light","i").test(s)?"LIGHT":new RegExp("wifi","i").test(s)?"NETWORKS":new RegExp("co","i").test(s)?"CO":new RegExp("no2","i").test(s)?"NO2":s,e.toUpperCase()}function e(t){var e;switch(t){case"TEMPERATURE":e="°C";break;case"LIGHT":e="LUX";break;case"SOUND":e="DB";break;case"HUMIDITY":case"BATTERY":e="%";break;case"CO":case"NO2":e="KΩ";break;case"NETWORKS":e="#";break;case"SOLAR PANEL":e="V";break;default:e="N/A"}return e}function n(t){var e=t.value;return e?(e=e.toString(),-1!==e.indexOf(".")&&(e=e.slice(0,e.indexOf(".")+3)),e):"N/A"}function s(t){return t.prev_value}function a(t){switch(t){case"TEMPERATURE":return"./assets/images/temperature_icon.svg";case"HUMIDITY":return"./assets/images/humidity_icon.svg";case"LIGHT":return"./assets/images/light_icon.svg";case"SOUND":return"./assets/images/sound_icon.svg";case"CO":return"./assets/images/co_icon.svg";case"NO2":return"./assets/images/no2_icon.svg";case"NETWORKS":return"./assets/images/networks_icon.svg";case"BATTERY":return"./assets/images/battery_icon.svg";case"SOLAR PANEL":return"./assets/images/solar_panel_icon.svg";default:return"./assets/images/avatar.svg"}}function i(t){var e=n(t),a=s(t);return e>a?"./assets/images/arrow_up_icon.svg":a>e?"./assets/images/arrow_down_icon.svg":"./assets/images/equal_icon.svg"}function o(t){switch(t){case"TEMPERATURE":return"#ffc107";case"HUMIDITY":return"#4fc3f7";case"LIGHT":return"#ffee58";case"SOUND":return"#f06292";case"CO":return"#4caf50";case"NO2":return"#8bc34a";case"NETWORKS":return"#9575cd";case"SOLAR PANEL":return"#fff9c4";default:return"black"}}angular.module("app.components").factory("Sensor",function(){function s(s){this.name=t(s),this.id=s.id,this.unit=e(this.name),this.value=n(s),this.icon=a(this.name),this.arrow=i(s),this.color=o(this.name)}return s})}(),function(){"use strict";function t(t){var e="",n=t.data.location.city,s=t.data.location.country;return n&&(e+=n),s&&(e+=", "+s),e}function e(t){var e="new"===t.device.status?"offline":t.device.status,n=t.data.location.exposure;return{status:e,exposure:n}}function n(t){var e;return new RegExp("sck","i").test(t.kit.name)&&(e="SmartCitizen Kit"),e}function s(t){return t?t.toLowerCase().split(" ").join("_"):""}function a(t){return t.updated_at}function i(t){return t.kit.name.match(/[0-9]+.?[0-9]*/)[0]}function o(t){return{username:t.owner.username,kits:t.owner.device_ids,location:t.owner.location.city&&t.owner.location.country?t.owner.location.city+", "+t.owner.location.country:"Barcelona, Spain",url:t.owner.url||"http://www.example.com",avatar:t.owner.avatar||"./assets/images/avatar.svg"}}function r(t){var e=c(t),n=s(e);return{name:e,className:n}}function c(){return"Never published"}angular.module("app.components").factory("Kit",["Sensor",function(c){function l(c,l){l&&"preview"===l.type?(this.name=c.device.name||"No Name",this.type=n(c),this.location=t(c)||"No location",this.avatar="./assets/images/avatar.svg",this.state=r(c),this.labels=e(c)):(this.name=c.device.name,this.type=n(c),this.version=i(c),this.avatar="./assets/images/avatar.svg",this.lastTime=moment(a(c)).fromNow(),this.location=t(c),this.labels=e(c),this["class"]=s(n(c)),this.id=c.device.id,this.description=c.description,this.owner=o(c),this.data=c.data.sensors)}return l.prototype.getSensors=function(t){var e=this.data.map(function(t){return new c(t)});return"compare"===t.type&&e.unshift({name:"NONE",color:"white",id:-1}),e.reduce(function(e,n,s,a){return"BATTERY"===n.name&&(a.splice(s,1),"main"===t.type?(e[0]=a,e[1]=n):"compare"===t.type&&(e=a)),e},[])},l}])}(),function(){"use strict";function t(t,e){function n(t){return e.all("users").post(t)}function s(t){return e.one("users",t).get()}function a(t){return e.all("me").customPUT(t)}function i(){return e.all("me").remove()}var o={createUser:n,getUser:s,updateUser:a,removeUser:i};return o}angular.module("app.components").factory("user",t),t.$inject=["$http","Restangular","auth"]}(),function(){"use strict";function t(t,e){function n(){return t.all("sensors").getList()}function s(t){t=t}function a(){return o}function i(n,s,a){var s=e.convertTime(s),a=e.convertTime(a);return s&&a?t.one("devices",n).customGET("pg_readings",{from:s,to:a,all_intervals:!0}):t.one("devices",n).customGET("pg_readings")}var o;n().then(function(t){console.log("sensors",t.plain()),s(t)});var r={callAPI:n,setTypes:s,getTypes:a,getSensorsData:i};return r}angular.module("app.components").factory("sensor",t),t.$inject=["Restangular","utils"]}(),function(){"use strict";function t(t,e){function n(t){return e.all("search").getList({q:t})}var s={globalSearch:n};return s}angular.module("app.components").factory("search",t),t.$inject=["$http","Restangular"]}(),function(){"use strict";function t(t){function e(t){a=t}function n(){return a}function s(){t.$broadcast("markerLoaded")}var a,i={setCurrentMarker:e,getCurrentMarker:n,dataLoaded:s};return i}angular.module("app.components").factory("marker",t),t.$inject=["$rootScope"]}(),function(){"use strict";function t(t){function e(){return s().success(function(t){var e=t.loc.split(",");return a={lat:parseFloat(e[0]),lng:parseFloat(e[1])}})}function n(){return a}function s(){return t.jsonp("http://ipinfo.io/?callback=JSON_CALLBACK")}var a;e();var i={getPosition:e,callAPI:s,getPositionObj:n};return i}angular.module("app.components").factory("geolocation",t),t.$inject=["$http"]}(),function(){"use strict";function t(t){function e(e){var n="";return n+=e.lat+","+e.lng,t.all("devices").getList({near:n})}function n(){return t.all("devices/world_map").getList()}function s(e){return t.one("devices",e).get()}var a={getDevices:e,getAllDevices:n,getDevice:s};return a}angular.module("app.components").factory("device",t),t.$inject=["Restangular"]}(),function(){"use strict";function t(t,e,n,s,a){function i(){o()}function o(){p.token=e.localStorage.getItem("smartcitizen.token"),p.token&&m().then(function(t){p.data=new a(t),s.$broadcast("loggedIn")})}function r(){return p}function c(){return!!p.token}function l(t){e.localStorage.setItem("smartcitizen.token",t),o()}function d(t){return n.all("sessions").post(t)}function u(){e.localStorage.removeItem("smartcitizen.token")}function m(){return n.all("").customGET("me")}var p={token:null,data:null};setTimeout(function(){i()},1e3);var v={isAuth:c,setCurrentUser:o,getCurrentUser:r,saveToken:l,login:d,logout:u};return v}angular.module("app.components").factory("auth",t),t.$inject=["$http","$window","Restangular","$rootScope","User"]}(),function(){"use strict";function t(t,e){function n(t,n){setTimeout(function(){s(n[0])},1e3),t.$watch("chartData",function(t){if(t&&void 0!==t){if(t[0]&&t[1]){var s=t[0].data,i=s.map(function(t){return{date:w(t.time),count:t&&t.data}});i.sort(function(t,e){return t.date-e.date});var o=t[1].data,r=o.map(function(t){return{date:w(t.time),count:t&&t.data}});r.sort(function(t,e){return t.date-e.date});var c=[i,r],l=[t[0].color,t[1].color],d=[t[0].unit,t[1].unit];a(c,{type:"both",container:n[0],color:l,unit:d})}else if(t[0]){var u=t[0].data,c=u.map(function(t){return{date:w(t.time),count:t&&t.data}});c.sort(function(t,e){return t.date-e.date});var m=t[0].color,p=t[0].unit;a(c,{type:"main",container:n[0],color:m,unit:p})}e.hideSpinner()}})}function s(t){m={top:20,right:15,bottom:20,left:40},p=t.clientWidth-m.left-m.right,v=t.clientHeight-m.top-m.bottom,f=d3.time.scale().range([0,p]),_=d3.scale.linear().range([v,0]),h=d3.scale.linear().range([v,0]),D=d3.scale.linear().range([v,0]),w=d3.time.format.utc("%Y-%m-%dT%H:%M:%SZ").parse,k=d3.svg.axis().scale(f).orient("bottom").ticks(5),b=d3.svg.axis().scale(_).orient("left").ticks(5),y=d3.svg.axis().scale(h).orient("right").ticks(5),x=d3.svg.area().interpolate("linear").x(function(t){return f(t.date)}).y0(v).y1(function(t){return _(t.count)}),S=d3.svg.line().interpolate("linear").x(function(t){return f(t.date)}).y(function(t){return _(t.count)}),$=d3.svg.area().interpolate("linear").x(function(t){return f(t.date)}).y0(v).y1(function(t){return h(t.count)}),T=d3.svg.line().interpolate("linear").x(function(t){return f(t.date)}).y(function(t){return h(t.count)}),g=d3.select(t).append("svg").attr("width",p+m.left+m.right).attr("height",v+m.top+m.bottom).append("g").attr("transform","translate("+(m.left-m.right)+","+m.top+")")}function a(t,e){"main"===e.type?i(t,e):"both"===e.type&&o(t,e)}function i(t,e){function n(){var n=d3.bisector(function(t){return t.date}).left,s=f.invert(d3.mouse(this)[0]),a=n(t,s,1),i=t[a-1],o=t[a],r=s-i.date>o.date-s?o:i;C.attr("transform","translate("+f(r.date)+", "+_(r.count)+")"),L.attr("transform","translate("+(f(r.date)+80)+", "+(d3.mouse(this)[1]-20)+")");var c=L.select("text"),m=c.select(".popup_main"),p=(m.select(".popup_value").text(l(r.count)),m.select(".popup_unit").text(e.unit),c.select(".popup_date").text(d(r.date))),v=[m,p];u(U,v)}f.domain(d3.extent(t,function(t){return t.date})),_.domain([.8*d3.min(t,function(t){return t.count}),1.2*d3.max(t,function(t){return t.count})]),g.selectAll("*").remove();var s=(d3.select(".chart_container svg"),g.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("y1","0%").attr("x1","0%").attr("y2","100%").attr("x2","100%").attr("spreadMethod","pad"));s.append("svg:stop").attr("offset","0%").attr("stop-color","black").attr("stop-opacity",1),s.append("svg:stop").attr("offset","100%").attr("stop-color","white").attr("stop-opacity",1),g.append("path").datum(t).attr("class","chart_area").attr("fill",e.color).attr("d",x),g.append("path").attr("class","chart_line").attr("stroke",e.color).attr("d",S(t)),g.append("g").attr("class","axis x").attr("transform","translate(0,"+v+")").call(k),g.append("g").attr("class","axis y_left").style("fill",e.color).call(b),g.append("g").attr("class","grid").attr("transform","translate(0,"+v+")").call(r().tickSize(-v,0,0).tickFormat("")),g.append("g").attr("class","grid").call(c().tickSize(-p,0,0).tickFormat("")),C=g.append("g").attr("class","focus").style("display","none"),C.append("circle").style("stroke",e.color).attr("r",4.5);var a=84,i=46;L=g.append("g").attr("class","focus").style("display","none"),U=L.append("rect").attr("width",a).attr("height",i).attr("transform",function(){var t="translate(-42, 5)";return t}).style("stroke","grey").style("stroke-width","0.5").style("fill","white");var o=L.append("text").attr("class",""),m=o.append("tspan").attr("class","popup_main").attr("text-anchor","start").attr("x",-a/2).attr("dx",8).attr("y",i/2).attr("dy",3);m.append("tspan").attr("class","popup_value"),m.append("tspan").attr("class","popup_unit").attr("dx",5),o.append("tspan").attr("class","popup_date").attr("x",-a/2).attr("dx",8).attr("y",i-2).attr("dy",0).attr("text-anchor","start"),g.append("rect").attr("class","overlay").attr("width",p).attr("height",v).on("mouseover",function(){L.style("display",null),C.style("display",null)}).on("mouseout",function(){L.style("display","none"),C.style("display","none")}).on("mousemove",n)}function o(t,e){function n(){var n=d3.bisector(function(t){return t.date}).left,s=f.invert(d3.mouse(this)[0]),a=n(t[1],s,1),i=t[1][a-1],o=t[1][a],r=s-i.date>o.date-s?o:i;P.attr("transform","translate("+f(r.date)+", "+h(r.count)+")");var c=t[0][a-1],m=t[0][a],p=s-c.date>m.date-s?m:c;C.attr("transform","translate("+f(p.date)+", "+_(p.count)+")"),L.attr("transform","translate("+(f(r.date)+80)+", "+(d3.mouse(this)[1]-20)+")");var v=L.select("text"),g=v.select(".popup_main");g.select(".popup_value").text(l(p.count)),g.select(".popup_unit").text(e.unit[0]);var k=v.select(".popup_compare");k.select(".popup_value").text(l(r.count)),k.select(".popup_unit").text(e.unit[1]);var b=v.select(".popup_date").text(d(r.date)),y=[g,k,b];u(U,y)}f.domain(d3.extent(t[0],function(t){return t.date})),_.domain([.8*d3.min(t[0],function(t){return t.count}),1.2*d3.max(t[0],function(t){return t.count})]),h.domain([.8*d3.min(t[1],function(t){return t.count}),1.2*d3.max(t[1],function(t){return t.count})]),g.selectAll("*").remove(),g.append("path").datum(t[0]).attr("class","chart_area").attr("fill",e.color[0]).attr("d",x),g.append("path").datum(t[1]).attr("class","chart_area").attr("fill",e.color[1]).attr("d",$),g.append("path").attr("class","chart_line").attr("stroke",e.color[0]).attr("d",S(t[0])),g.append("path").attr("class","chart_line").attr("stroke",e.color[1]).attr("d",T(t[1])),g.append("g").attr("class","axis x").attr("transform","translate(0,"+v+")").call(k),g.append("g").attr("class","axis y_left").style("fill",e.color[0]).call(b),g.append("g").attr("class","axis y_right").style("fill",e.color[1]).attr("transform","translate("+p+" ,0)").call(y),g.append("g").attr("class","grid").attr("transform","translate(0,"+v+")").call(r().tickSize(-v,0,0).tickFormat("")),g.append("g").attr("class","grid").call(c().tickSize(-p,0,0).tickFormat("")),P=g.append("g").attr("class","focus").style("display","none"),C=g.append("g").attr("class","focus").style("display","none"),P.append("circle").style("stroke",e.color[1]).attr("r",4.5),C.append("circle").style("stroke",e.color[0]).attr("r",4.5);var s=84,a=75;L=g.append("g").attr("class","focus").style("display","none"),U=L.append("rect").attr("width",s).attr("height",a).style("min-width","40px").attr("transform",function(){var t="translate(-42, 5)";return t}).style("stroke","grey").style("stroke-width","0.5").style("fill","white"),L.append("rect").attr("width",8).attr("height",2).attr("transform",function(){return"translate("+(-s/2+4).toString()+", 20)"}).style("fill",e.color[0]),L.append("rect").attr("width",8).attr("height",2).attr("transform",function(){return"translate("+(-s/2+4).toString()+", 45)"}).style("fill",e.color[1]);var i=L.append("text").attr("class",""),o=i.append("tspan").attr("class","popup_main").attr("x",-a/2+7).attr("dx",8).attr("y",a/3).attr("dy",3);o.append("tspan").attr("class","popup_value").attr("text-anchor","start"),o.append("tspan").attr("class","popup_unit").attr("dx",5);var m=i.append("tspan").attr("class","popup_compare").attr("x",-a/2+7).attr("dx",8).attr("y",a/1.5).attr("dy",3);m.append("tspan").attr("class","popup_value").attr("text-anchor","start"),m.append("tspan").attr("class","popup_unit").attr("dx",5),i.append("tspan").attr("class","popup_date").attr("x",-s/2).attr("dx",8).attr("y",a-2).attr("dy",0).attr("text-anchor","start"),g.append("rect").attr("class","overlay").attr("width",p).attr("height",v).on("mouseover",function(){P.style("display",null),C.style("display",null),L.style("display",null)}).on("mouseout",function(){P.style("display","none"),C.style("display","none"),L.style("display","none")}).on("mousemove",n)}function r(){return d3.svg.axis().scale(f).orient("bottom").ticks(5)}function c(){return d3.svg.axis().scale(_).orient("left").ticks(5)}function l(t){if(-1!==t.toString().indexOf(".")){var e=t.toString().split(".");return e[0]+"."+e[1].slice(0,2)}return t.toString().slice(0,2)}function d(t){return moment(t).format("ddd Do MMM YYYY")}function u(t,e){function n(t){return t.node().getBBox()}if(e.length){var s=e.reduce(function(t,e){var s=n(e),a=n(t);return a.width>=s.width?t:e},e[0]),a=2*s.attr("dx");t.attr("width",n(s).width+a)}}var m,p,v,g,f,_,h,k,b,y,w,x,S,$,T,P,C,L,D,U;return{link:n,restrict:"A",scope:{chartData:"="}}}angular.module("app.components").directive("chart",t),t.$inject=["sensor","animation"]}(),function(){"use strict";function t(){function t(t,e){t.element=e}function e(t){t.slidePosition=0,t.slideSize=20,this.getTimesSlided=function(){return t.slideSize},this.getPosition=function(){return t.slidePosition*t.slideSize},this.decrementPosition=function(){t.slidePosition-=1},this.incrementPosition=function(){t.slidePosition+=1},this.scrollIsValid=function(e){var n=t.element.scrollLeft();return console.log("scrollpos",n),"left"===e?n>0&&t.slidePosition>=0:"right"===e?300>n:void 0}}return e.$inject=["$scope"],{controller:e,link:t}}function e(){function t(t,e,n,s){var a=angular.element(".sensors_container");e.on("click",function(){s.scrollIsValid("left")&&"left"===n.direction?(s.decrementPosition(),a.scrollLeft(s.getPosition()),console.log(s.getPosition())):s.scrollIsValid("right")&&"right"===n.direction&&(s.incrementPosition(),a.scrollLeft(s.getPosition()),console.log(s.getPosition()))})}return{link:t,require:"^slide-menu",restrict:"A",scope:{direction:"@"}}}angular.module("app.components").directive("slide",e).directive("slideMenu",t),e.$inject=[]}(),function(){"use strict";function t(){function t(t){n=t}function e(){return n}var n,s={setKit:t,getKit:e};return s}angular.module("app.components").factory("layout",t)}(),function(){"use strict";function t(t){function e(){t.$broadcast("blur")}function n(){t.$broadcast("unblur")}function s(){t.$broadcast("removeNav")}function a(){t.$broadcast("addNav")}function i(){t.$broadcast("showSpinner")}function o(){t.$broadcast("hideSpinner")}var r={blur:e,unblur:n,removeNav:s,addNav:a,showSpinner:i,hideSpinner:o};return r}angular.module("app.components").factory("animation",t),t.$inject=["$rootScope"]}(),function(){"use strict";function t(){function t(t,e){t.$watch("moveDown",function(t){t?e.addClass("move_down"):e.removeClass("move_down")})}return{link:t,scope:!1,restrict:"A"}}function e(t,e){function n(n,s){var a=s[0].offsetTop,i=angular.element(".stickNav").height();e(function(){a=s[0].offsetTop,i=angular.element(".stickNav").height()},1e3),angular.element(t).on("scroll",function(){var t=document.body.scrollTop;t+i>=a?(s.addClass("stickMenu"),n.$apply(function(){n.moveDown=!0})):(s.removeClass("stickMenu"),n.$apply(function(){n.moveDown=!1}))})}return{link:n,scope:!1,restrict:"A"}}function n(){function t(t,e){t.$on("blur",function(){e.addClass("blur")}),t.$on("unblur",function(){e.removeClass("blur")})}return{link:t,scope:!1,restrict:"A"}}function s(t){function e(e,n){n.on("focusin",function(){t.removeNav()}),n.on("focusout",function(){t.addNav()});var s=n.find("input");s.on("blur",function(){angular.element(document.body).css("overflow","auto")
})}return{link:e}}function a(t,e,n){function s(e,s){{var a=t[0].body.clientHeight,i=angular.element(".stickNav").height();angular.element(".kit_overview").height(),angular.element(".kit_menu").height(),angular.element(".kit_chart").height()}n(function(){var t=angular.element(".kit_overview").height(),e=angular.element(".kit_menu").height(),n=angular.element(".kit_chart").height(),o=a-i-e-t-n;s.css("height",o+"px")})}return{link:s,scope:!0,restrict:"A"}}function i(t,e){function n(t,n){e(function(){{var t=angular.element(".angular-leaflet-map").height(),e=angular.element(".stickNav").height();angular.element(".kit_chart").height()}n.css("margin-top",t+e+"px")})}return{link:n}}angular.module("app.components").directive("moveDown",t).directive("stick",e).directive("blur",n).directive("focus",s).directive("changeMapHeight",a).directive("changeContentMargin",i),t.$inject=[],e.$inject=["$window","$timeout"],s.$inject=["animation"],a.$inject=["$document","layout","$timeout"],i.$inject=["layout","$timeout"]}(),function(){"use strict";function t(t){function e(e,n){function s(t){angular.element(window).scrollTop(t-r.navbar.height-r.kitMenu.height)}function a(t){return c[t]}function i(){var t=angular.element(".md-button.button_active");if(t.length){t.removeClass("button_active");var e=t.find(".stroke_container");e.css("stroke","none"),e.css("stroke-width","1");var n=e.find(".fill_container");n.css("fill","#82A7B0")}}function o(t){var e=angular.element(t);e.addClass("button_active");var n=e.find(".stroke_container");n.css("stroke","white"),n.css("stroke-width","0.01px");var s=n.find(".fill_container");s.css("fill","white")}var r,c=n.children();t(function(){r={navbar:{height:angular.element(".stickNav").height()},kitMenu:{height:angular.element(".kit_menu").height()},kitOverview:{height:angular.element(".kit_overview").height(),offset:angular.element(".kit_overview").offset().top,buttonOrder:0},kitDashboard:{height:angular.element(".kit_chart").height(),offset:angular.element(".kit_chart").offset().top,buttonOrder:1},kitUser:{},kitComments:{}}},1e3);for(var l=0;l<c.length;l++){var d=c[l];angular.element(d).on("click",function(){var t=angular.element(this).index();for(var e in r)if(r[e].buttonOrder===t){var n=r[e].offset;s(n)}})}var u;angular.element(window).on("scroll",function(){var t=document.body.scrollTop,e=t+r.navbar.height+r.kitMenu.height;if("none"!==u&&e<=r.kitOverview.offset){var n=a(r.kitOverview.buttonOrder);i(),u="none"}else if("overview"!==u&&e>=r.kitOverview.offset&&e<=r.kitOverview.offset+r.kitOverview.height){var n=a(r.kitOverview.buttonOrder);i(),o(n),u="overview"}else if("chart"!==u&&e>=r.kitDashboard.offset&&e<=r.kitDashboard.offset+r.kitDashboard.height){var n=a(r.kitDashboard.buttonOrder);i(),o(n),u="chart"}})}return{link:e,restrict:"A"}}angular.module("app.components").directive("activeButton",t),t.$inject=["$timeout"]}(),function(){"use strict";function t(t){function e(t){a("success",t)}function n(t){a("error",t)}function s(t){a("info",t)}function a(e,n,s){s=void 0===s?"top":s,t.show({controller:"AlertController",controllerAs:"vm",templateUrl:"app/components/alert/alert"+e+".html",hideDelay:1e4,position:s,locals:{message:n}})}var i={success:e,error:n,info:s};return i}angular.module("app.components").factory("alert",t),t.$inject=["$mdToast"]}(),function(){"use strict";function t(t,e){function n(){t.hide()}var s=this;s.close=n,s.message=e}angular.module("app.components").controller("AlertController",t),t.$inject=["$mdToast","message"]}(),function(){"use strict";angular.module("app.auth",[])}(),function(){"use strict"}(),angular.module("app",["ngMaterial","ui.router","restangular","angularSpinner","ngDropdowns","app.components","app.auth"]),function(){"use strict";function t(t,e,n,s){t.state("landing",{url:"/",resolve:{location:["geolocation",function(t){var e=t.getPositionObj();return e?e:t.callAPI().then(function(t){var e=t.data.loc.split(","),n={lat:parseFloat(e[0]),lng:parseFloat(e[1])};return n})}],initialMarkers:["$state","device","location",function(t,e,n){return e.getDevices(n).then(function(e){e=e.plain();var n=e[0];t.go("home.kit",{id:n.id})})}]}}).state("home",{url:"","abstract":!0,views:{"":{templateUrl:"app/components/home/template.html"},"map@home":{templateUrl:"app/components/map/map.html",controller:"MapController",controllerAs:"vm"}},resolve:{location:["geolocation",function(t){return t.callAPI().then(function(t){var e=t.data.loc.split(","),n={lat:parseFloat(e[0]),lng:parseFloat(e[1])};return n})}],sensorTypes:["sensor",function(t){return t.callAPI().then(function(t){return t=t.plain()})}],initialMarkers:["$state","device","location","utils","sensorTypes","Kit",function(t,e,n,s){return e.getDevices(n).then(function(t){t=t.plain();var e=t.map(function(t){var e=s.parseKit(t),n={lat:t.data.location.latitude,lng:t.data.location.longitude,message:'<div class="popup"><div class="popup_top '+e.kitClass+'"><p class="popup_name">'+e.kitName+'</p><p class="popup_type">'+e.kitType+'</p><p class="popup_time"><md-icon md-svg-src="./assets/images/update_icon.svg"></md-icon>'+e.kitLastTime+'</p></div><div class="popup_bottom"><p class="popup_location"><md-icon md-svg-src="./assets/images/location_icon.svg"></md-icon>'+e.kitLocation+'</p><div class="popup_labels"><span>'+e.kitLabels.status+"</span><span>"+e.kitLabels.exposure+"</span></div></div></div>",status:t.status,myData:{id:t.id}};return n});return e})}],initialPopup:["leafletData","initialMarkers",function(t,e){var n=e[0].myData.id;t.getMap().then(function(t){for(var e in t._layers)if(t._layers[e].options.myData){var s=t._layers[e].options.myData.id;s===n&&angular.element(t._layers[e]._icon).click()}})}]}}).state("home.kit",{url:"/kits/:id",views:{"container@home":{templateUrl:"app/components/kit/kit.html",controller:"KitController",controllerAs:"vm"}},resolve:{marker:["$stateParams","device","marker",function(t,e,n){return e.getDevice(t.id).then(function(t){return t=t.plain(),n.setCurrentMarker(t),n.dataLoaded(),t})}]}}).state("userProfile",{url:"/users/:id",templateUrl:"app/components/userProfile/userProfile.html",controller:"UserProfileController",controllerAs:"vm",resolve:{userData:["$stateParams","user",function(t,e){var n=t.id;return e.getUser(n).then(function(t){return t})}]}}).state("myProfile",{url:"/profile",authenticate:!0,templateUrl:"app/components/myProfile/myProfile.html",controller:"MyProfileController",controllerAs:"vm",resolve:{authUser:["user","auth",function(t,e){var n=e.getCurrentUser().data&&e.getCurrentUser().data.id;if(n)return t.getUser().then(function(t){return t})}]}}),e.otherwise("/"),n.html5Mode({enabled:!0,requireBase:!1}).hashPrefix("!"),s.setBaseUrl("https://new-api.smartcitizen.me/v0")}angular.module("app").config(t),t.$inject=["$stateProvider","$urlRouterProvider","$locationProvider","RestangularProvider"]}(),function(){"use strict";function t(t,e,n){t.$on("$stateChangeStart",function(){}),e.addFullRequestInterceptor(function(t,e,s,a,i,o,r){if(n.isAuth()){var c=n.getCurrentUser().token;i.Authorization="Bearer "+c}return{element:t,headers:i,params:o,httpConfig:r}})}angular.module("app").run(t),t.$inject=["$rootScope","Restangular","auth","$templateCache"]}(),angular.module("app").run(["$templateCache",function(t){t.put("app/components/alert/alerterror.html",'<md-toast class="red"><md-icon md-svg-src="./assets/images/alert_icon.svg" alt="Insert Drive Icon" class="alert_icon"></md-icon><span flex="">{{ vm.message }}</span><md-button ng-click="vm.close()"><md-icon md-svg-src="./assets/images/close_icon_black.svg" alt="Insert Drive Icon" class="close_icon"></md-icon></md-button></md-toast>'),t.put("app/components/alert/alertinfo.html",'<md-toast class="blue"><md-icon md-svg-src="./assets/images/alert_icon.svg" alt="Insert Drive Icon" class="alert_icon"></md-icon><span flex="">{{ vm.message }}</span><md-button ng-click="vm.close()"><md-icon md-svg-src="./assets/images/close_icon_black.svg" alt="Insert Drive Icon" class="close_icon"></md-icon></md-button></md-toast>'),t.put("app/components/alert/alertsuccess.html",'<md-toast class="green"><md-icon md-svg-src="./assets/images/alert_icon.svg" alt="Insert Drive Icon" class="alert_icon"></md-icon><span flex="">{{ vm.message }}</span><md-button ng-click="vm.close()"><md-icon md-svg-src="./assets/images/close_icon_black.svg" alt="Insert Drive Icon" class="close_icon"></md-icon></md-button></md-toast>'),t.put("app/components/home/home.html",'<div layout="vertical" layout-fill=""><md-content><section class="content"><section class="map"><h1>Here\'s the map</h1></section><section class="kit_data"><section class="kit_menu" layout="row" layout-align="center center" stick=""><p>Bar with kit info</p></section><section class="kit_fixed" move-down=""><section class="kit_overview" layout="row" layout-align="center center"><p>Kit data overview</p></section><section class="kit_detailed" layout="row" layout-align="center center"><section class="kit_chart"><p>Here it\'s the data</p></section></section></section></section></section></md-content></div>'),t.put("app/components/home/template.html",'<div layout="vertical" layout-fill=""><md-content><section class="content"><div ui-view="map" class="map_state"></div><div ui-view="container" class="kit"></div></section></md-content></div>'),t.put("app/components/kit/kit.html",'<section class="kit_data" change-content-margin=""><section class="kit_menu" layout="row" layout-align="center center" stick=""><div class="container"><div class="kit_user"><md-icon md-svg-src="{{ vm.marker.owner.avatar || \'./assets/images/avatar.svg\'}}"></md-icon><span>{{ vm.marker.owner.username}}</span></div><div class="kit_name"><md-icon md-svg-src="./assets/images/sensor_icon.svg"></md-icon><span>{{ vm.marker.device.name }}</span></div><div class="kit_battery"><md-icon md-svg-src="{{ vm.battery.icon }}"></md-icon><span>{{ vm.battery.value }} {{ vm.battery.unit }}</span></div><div class="kit_navbar" active-button=""><md-button href="#" class="md-flat chart_icon" aria-label=""><md-icon md-svg-src="./assets/images/chart_icon.svg"></md-icon></md-button><md-button href="#" class="md-flat kit_details_icon" aria-label=""><md-icon md-svg-src="./assets/images/kit_details_icon.svg"></md-icon></md-button><md-button href="#" class="md-flat user_details" aria-label=""><md-icon md-svg-src="./assets/images/user_details_icon.svg"></md-icon></md-button><md-button href="#" class="md-flat discussion_icon" aria-label=""><md-icon md-svg-src="./assets/images/discussion_icon.svg"></md-icon></md-button><md-button href="" class="md-flat shape_icon kit_owner_dropdown_button" aria-label="" dropdown-menu="vm.dropdownOptions" dropdown-model="vm.dropdownSelected" dropdown-item-label="text"><md-icon md-svg-src="./assets/images/shape_icon.svg"></md-icon></md-button></div></div></section><section class="kit_fixed" move-down=""><section class="kit_overview"><md-button ng-click="vm.slide(\'right\')" class="md-flat button_scroll button_scroll_left" layout="column" layout-align="center center" aria-label=""><md-icon md-svg-src="./assets/images/arrow_left_icon.svg"></md-icon></md-button><div class="sensors_container" layout="row" layout-align="center center"><div ng-repeat="sensor in vm.sensors" class="sensor_container"><md-icon md-svg-src="{{ sensor.icon }}" class="sensor_icon"></md-icon><div class="sensor_value">{{ sensor.value }}</div><div class="sensor_right"><div class="sensor_unit">{{ sensor.unit }}</div><md-icon md-svg-src="{{ sensor.arrow }}" class="sensor_arrow"></md-icon></div><div class="clear"></div><div class="sensor_name">{{ sensor.name }}</div></div></div><md-button ng-click="vm.slide(\'left\')" class="md-flat button_scroll button_scroll_right" layout="column" layout-align="center center" aria-label=""><md-icon md-svg-src="./assets/images/arrow_right_icon.svg"></md-icon></md-button></section><section class="kit_detailed"><section class="kit_chart"><div class="container" layout="row"><div class="kit_chart_left"><div class="sensor_select"><md-icon md-svg-src="{{ vm.selectedSensorData.icon }}" class="sensor_icon_selected"></md-icon><md-select placeholder="Choose sensor" ng-model="vm.selectedSensor"><md-option ng-repeat="sensor in vm.sensors" ng-value="{{sensor.id}}" ng-selected="$first"><img class="select_image" src="{{ sensor.icon }}"> <span>{{ sensor.name }}</span></md-option></md-select></div><div class="sensor_data"><span class="sensor_value">{{ vm.selectedSensorData.value }}<span><span class="sensor_unit">{{ vm.selectedSensorData.unit }}</span></span></span></div><div class="sensor_description"><h6>{{ vm.sensors[vm.selectedSensor].name }}</h6><p>Lorep ipsum Lorep ipsumLorep ipsumLorep ipsumLorep ipsumLorep ipsumLorep ipsum <a href="#">More info</a></p></div><div class="sensor_compare"><p><span>Compare with</span><md-select placeholder="NONE" ng-model="vm.selectedSensorToCompare"><md-option ng-repeat="sensor in vm.sensorsToCompare" ng-value="{{sensor.id}}"><img class="select_image" src="{{ sensor.icon }}"> <span class="sensor_name">{{ sensor.name }}</span></md-option></md-select></p></div></div><div class="kit_chart_right" flex=""><div class="chart_navigation"><div class="kit_time"><md-icon class="kit_time_icon" md-svg-src="./assets/images/update_icon.svg"></md-icon>{{ vm.marker.time }}</div><div class="picker_container"><label for="picker_from">From:</label> <input type="text" id="picker_from" class="date_picker" placeholder="FROM"></div><div class="picker_container"><label for="picker_to">To:</label> <input type="text" id="picker_to" class="date_picker" placeholder="TO"></div><div class="chart_move"><md-button href="#" ng-click="vm.moveChart(\'left\')" class="chart_move_button chart_move_left" aria-label=""><md-icon md-svg-src="./assets/images/arrow_left_icon.svg"></md-icon></md-button><md-button href="#" ng-click="vm.moveChart(\'right\')" class="chart_move_button chart_move_right" aria-label=""><md-icon md-svg-src="./assets/images/arrow_right_icon.svg"></md-icon></md-button></div></div><div style="clear: both"></div><div chart="" class="chart_container" chart-data="vm.chartDataMain"><div ng-show="vm.loadingChart" us-spinner="{color: \'white\'}"></div></div></div></div></section><section class="kit_details"><div class="kit_detailed_content_container"><div class="kit_detailed_title_container"><md-icon class="kit_detailed_icon_title" md-svg-src="./assets/images/kit_details_icon.svg"></md-icon><h2 class="kit_detailed_title">KIT DETAILS</h2></div><div class="kit_detailed_content_container"><div class="kit_detailed_avatar"><md-icon md-svg-src="{{ vm.kit.avatar }}"></md-icon></div><div class="kit_details_content"><h3 class="kit_detailed_name kit_details_name">{{ vm.kit.name }}</h3><p class="kit_details_location"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/location_icon.svg"></md-icon><span>{{ vm.kit.location }}</span></p><p class="kit_details_type"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/kit_details_icon.svg"></md-icon><span>{{ vm.kit.type }}</span> <span class="kit_details_version"><span>SCK:</span> {{ vm.kit.version }}</span> <span class="kit_details_id"><span>ID:</span> {{ vm.kit.id }}</span></p><p class="kit_details_lastTime"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/update_icon.svg"></md-icon><span>{{ vm.kit.lastTime }}</span></p><p class="kit_details_labels"><span ng-repeat="label in vm.kit.labels">{{ label }}</span></p><div class="kit_details_description"><h4 class="kit_details_description_title">Kit Description:</h4><p class="kit_details_description_content">{{ vm.kit.description }}</p></div></div></div><div class="kit_details_manage"><div class="kit_details_manage_buttons"><md-button href="#" ng-click="" class="kit_details_button_setup" aria-label="">SET UP</md-button><md-button href="#" ng-click="" class="kit_details_button_edit" aria-label="">EDIT</md-button><md-button href="#" ng-click="" class="kit_details_button_delete" aria-label="">DELETE</md-button></div><div class="kit_details_manage_data"><div class="kit_details_macaddress"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/mac_address_icon.svg"></md-icon><span class="kit_details_manage_data_name">Mac Address:</span> <span>00:00:00:00:01</span></div><div class="kit_details_debug"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/debug_icon.svg"></md-icon><span class="kit_details_manage_data_name">Debug mode:</span> <span>Enabled</span></div><div class="kit_details_key"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/key_icon.svg"></md-icon><span class="kit_details_manage_data_name">API Key:</span> <span>34334324233d3f4f3</span></div><div class="kit_details_download"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/download_icon.svg"></md-icon><span class="kit_details_manage_data_name">Download Data</span> <span>Choose your format</span></div></div></div></div></section><section class="kit_owner"><div class="kit_detailed_content_container"><div class="kit_detailed_title_container"><md-icon class="kit_detailed_icon_title" md-svg-src="./assets/images/user_details_icon.svg"></md-icon><h2 class="kit_detailed_title">KIT OWNER</h2></div><div class="kit_detailed_content_container"><div class="kit_detailed_avatar"><md-icon md-svg-src="{{ vm.kit.owner.avatar }}"></md-icon></div><div class="kit_owner_content"><div class="kit_owner_info"><h3 class="kit_owner_username">{{ vm.kit.owner.username }}</h3><p class="kit_owner_location"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/location_icon.svg"></md-icon><span>{{ vm.kit.owner.location }}</span></p><p class="kit_owner_url"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/user_details_icon.svg"></md-icon><a ng-href="{{ vm.kit.owner.url }}">{{ vm.kit.owner.url }}</a></p></div><div class="kit_owner_kits"><h3 class="kit_owner_kits_title">Kits of {{ vm.kit.owner.username }}<h3><div class="kit_owner_kits_list" ng-repeat="kit in vm.ownerKits"><div class="kit_detailed_content_container"><div class="kit_owner_kits_list_avatar"><md-icon class="kit_owner_kits_list_avatar" md-svg-src="{{ kit.avatar }}"></md-icon></div><div class="kit_owner_kits_list_content"><p class="kit_owner_kits_list_name kit_detailed_name">{{ kit.name }}</p><p class="kit_owner_kits_list_data"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/location_icon.svg"></md-icon><span>{{ kit.location}}</span><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/sensor_icon.svg"></md-icon><span>{{ kit.type }}</span></p></div><div class="kit_owner_kits_list_config" layout="row" layout-align="center center"><div class="kit_owner_kits_list_state kit_owner_kits_list_{{ kit.state.className }}">{{ kit.state.name }}</div><md-button class="kit_owner_dropdown_button" dropdown-menu="vm.dropdownOptions" dropdown-model="vm.dropdownSelected" dropdown-item-label="text"><img src="./assets/images/config_icon.svg"></md-button></div></div></div><md-button href="#" ng-click="" class="kit_owner_kits_more_button" aria-label="">VIEW ALL KITS OF {{ vm.kit.owner.username }}</md-button></h3></h3></div></div></div></div><div class="clearfix"></div></section><section class="kit_comments"><div class="kit_detailed_content_container"><div class="kit_detailed_title_container"><md-icon class="kit_detailed_icon_title" md-svg-src="./assets/images/discussion_icon.svg"></md-icon><h2 class="kit_detailed_title">DISCUSSION</h2></div></div></section></section></section></section>'),t.put("app/components/login/login.html",'<md-button ng-click="showLogin($event)">Log In</md-button>'),t.put("app/components/login/loginModal.html",'<md-dialog><md-dialog-content class="modal modal_login"><md-button class="close_icon"><md-icon md-svg-icon="./assets/images/close_icon_blue.svg" ng-click="cancel()" class=""></md-icon></md-button><form name="signup_form" novalidate="" ng-submit="answer(vm.user)"><div class="modal_content_container"><h2>LOG IN</h2><div class="modal_message"><p>People looking for a better city</p><p>You\'re part of them? Feel free to join us!</p></div><div layout="" layout-sm="column" class="field"><md-input-container flex=""><label>Username</label> <input type="text" name="username" ng-model="vm.user.username" required=""></md-input-container><p class="errors" ng-show="signup_form.$submitted || signup_form.username.$touched"><span ng-show="signup_form.username.$error.required">Username is required</span></p></div><div layout="" layout-sm="column" class="field"><md-input-container flex=""><label>Password</label> <input type="password" name="password" ng-model="vm.user.password" required=""></md-input-container><p class="errors" ng-show="signup_form.$submitted || signup_form.password.$touched"><span ng-show="signup_form.password.$error.required">Password is required</span></p></div></div><button class="md-raised md-primary main" type="submit">LOG IN</button></form></md-dialog-content><p class="message_below"><span><span class="message_below_question">New here?</span><md-button class="message_below_link">SIGN IN</md-button></span> <span><span>Forgot your password?</span><md-button>REQUEST</md-button></span></p></md-dialog>'),t.put("app/components/map/map.html",'<section class="map" change-map-height=""><leaflet center="vm.center" tiles="vm.tiles" markers="vm.markers" defaults="vm.defaults" event-broadcast="vm.events" width="100%" height="100%"></leaflet></section>'),t.put("app/components/myProfile/myProfile.html",'<section class="myProfile_state"><div class="profile_header myProfile_header"><div class="myProfile_header_container" layout="row"><md-icon md-svg-src="./assets/images/user_details_icon.svg" class="profile_header_avatar myProfile_header_avatar"></md-icon><div class="profile_header_content"><div class="profile_header_name">{{ vm.user.username }}</div><div class="profile_header_location"><md-icon md-svg-src="./assets/images/location_icon.svg" class="profile_header_content_avatar"></md-icon><span>{{ vm.user.location }}</span></div><div class="profile_header_url"><md-icon md-svg-src="./assets/images/url_icon.svg" class="profile_header_content_avatar"></md-icon><span>{{ vm.user.url }}</span></div></div></div><md-tabs class="myProfile_tabs" md-dynamic-height=""><md-tab label=""><md-tab-label><md-icon md-svg-src="./assets/images/user_details_icon.svg" class="myProfile_tab_icon"></md-icon><span>PROFILE</span></md-tab-label><md-tab-body><div class="profile_content" layout="row"><div class="profile_sidebar"><p class="profile_sidebar_title">EDIT YOUR PROFILE</p><p class="profile_sidebar_description">A complete profile helps us to bring to you a better experience. Please, take your time completing all fields.</p></div><div class="profile_content_main" flex=""><div class="myProfile_content_form"><div class="myProfile_form_avatar"><md-icon md-svg-src="{{ vm.user.avatar }}" class="myProfile_tab_icon"></md-icon></div><div layout="" layout-sm="column" class="field myProfile_content_form_input"><md-input-container flex=""><label>Username</label> <input type="text" ng-model="vm.formUser.username"></md-input-container><p class="errors" ng-show="!!errors.username.length"><span ng-repeat="error in errors.username">Username {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field myProfile_content_form_input"><md-input-container flex=""><label>Password</label> <input type="password" ng-model="vm.formUser.password"></md-input-container><p class="errors" ng-show="!!errors.password.length"><span ng-repeat="error in errors.password">Password {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field myProfile_content_form_input"><md-input-container flex=""><label>Email</label> <input type="email" ng-model="vm.formUser.email"></md-input-container><p class="errors" ng-show="!!errors.email.length"><span ng-repeat="error in errors.email">Email {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field myProfile_content_form_input"><md-input-container flex=""><label>City</label> <input type="text" ng-model="vm.formUser.city"></md-input-container><p class="errors" ng-show="!!errors.city.length"><span ng-repeat="error in errors.city">City {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field myProfile_content_form_input"><md-input-container flex=""><label>Country</label> <input type="text" ng-model="vm.formUser.country"></md-input-container><p class="errors" ng-show="!!errors.country.length"><span ng-repeat="error in errors.country">Country {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field myProfile_content_form_input"><md-input-container flex=""><label>Website</label> <input type="text" ng-model="vm.formUser.url"></md-input-container><p class="errors" ng-show="!!errors.url.length"><span ng-repeat="error in errors.url">URL {{ error }}<span ng-if="!$last">,</span></span></p></div><md-button ng-click="vm.updateUser(vm.formUser)" class="myProfile_form_updateButton">UPDATE PROFILE</md-button><div class="clearfix"></div><div class="myProfile_apiKey"><md-icon md-svg-src="./assets/images/user_details_icon.svg" class="myProfile_tab_icon"></md-icon><span>API KEY</span></div><md-button ng-click="vm.removeUser()" class="myProfile_form_removeButton">DELETE ACCOUNT</md-button><small>Delete your profile will erase all your data. Please consider think twice before click this button.</small></div></div></div></md-tab-body></md-tab><md-tab label=""><md-tab-label><md-icon md-svg-src="./assets/images/kit_details_icon.svg" class="myProfile_tab_icon"></md-icon><span>KITS</span></md-tab-label><md-tab-body><div class="profile_content" layout="row"><div class="profile_sidebar"><p class="profile_sidebar_title">FILTER KITS BY</p><div class="profile_sidebar_options"><md-button ng-click="vm.filterKits(\'all\')" class="profile_sidebar_button">ALL</md-button><md-button ng-click="vm.filterKits(\'online\')" class="profile_sidebar_button">ONLINE</md-button><md-button ng-click="vm.filterKits(\'offline\')" class="profile_sidebar_button">OFFLINE</md-button></div></div><div class="profile_content_main" flex=""><div class="profile_content_main_top"><md-button class="myProfile_addKitButton">ADD A NEW KIT</md-button><span class="myProfile_content_main_title">0 kits filtering by ALL</span></div><div class=""><div class="kitList" ng-repeat="kit in (vm.filteredKits = (vm.kits | filter: { labels: { status: vm.status } } ))"><div class="kitList_container"><div class=""><md-icon class="kitList_avatar" md-svg-src="{{ kit.avatar }}"></md-icon></div><div class="kitList_content"><div class="kitList_name">{{ kit.name }}</div><div class="kitList_data"><md-icon class="kitList_icon" md-svg-src="./assets/images/location_icon.svg"></md-icon><span>{{ kit.location }}</span><md-icon class="kitList_icon" md-svg-src="./assets/images/sensor_icon.svg"></md-icon><span>{{ kit.type }}</span></div></div><div class="kitList_config" layout="row" layout-align="center center"><div class="kitList_state kitList_state_{{ kit.state.className }}">{{ kit.state.name }}</div><md-button class="kitList_dropdownButton" dropdown-menu="vm.dropdownOptions" dropdown-model="vm.dropdownSelected" dropdown-item-label="text" aria-label=""><img src="./assets/images/config_icon.svg"></md-button></div></div></div></div></div></div></md-tab-body></md-tab><md-tab label=""><md-tab-label><md-icon md-svg-src="./assets/images/user_details_icon.svg" class="myProfile_tab_icon"></md-icon><span>TOOLS</span></md-tab-label><md-tab-body></md-tab-body></md-tab></md-tabs></div></section>'),t.put("app/components/navbar/navbar.html",'<md-toolbar layout="row" layout-align="end center" class="stickNav"><a href="/" class="logo_link"><md-icon md-svg-src="./assets/images/LogotipoSmartCitizen.svg" alt="Insert Drive Icon" class="logo_icon"></md-icon></a><section layout="row" class="nav_left" layout-align="space-around center"><md-button ng-show="vm.isShown" href="#" class="md-flat full_height map"><md-icon md-svg-src="./assets/images/map_icon.svg" class="nav_icon"></md-icon><span>Map</span></md-button><md-button ng-show="vm.isShown" href="#" class="md-flat full_height community"><md-icon md-svg-src="./assets/images/community_icon.svg" class="nav_icon"></md-icon><span>Community</span></md-button></section><search flex=""></search><section layout="row" class="nav_right" layout-align="space-around center"><md-button ng-show="vm.isShown" href="#" class="md-flat full_height get" ng-class="{navbar_highlight_button: vm.isLoggedin}">Get your Kit</md-button><div ng-show="!vm.isLoggedin" login="" class="navbar_login_button md-display-1"></div><div ng-show="!vm.isLoggedin" signup="" class="navbar_signup_button md-display-1"></div><md-button href="" class="md-flat navbar_avatar_button" aria-label="" dropdown-menu="vm.dropdownOptions" dropdown-model="vm.dropdownSelected" dropdown-item-label="text"><md-icon class="navbar_avatar_icon" md-svg-src="{{ vm.currentUser.avatar }}"></md-icon></md-button></section></md-toolbar>'),t.put("app/components/signup/signup.html",'<md-button ng-click="vm.showSignup($event)">Sign Up</md-button>'),t.put("app/components/signup/signupModal.html",'<md-dialog><md-dialog-content class="modal signup"><div><md-button class="close_icon"><md-icon md-svg-icon="./assets/images/close_icon_blue.svg" ng-click="cancel()" class=""></md-icon></md-button><h2>SIGN UP</h2><div class="modal_message"><p>People looking for a better city</p><p>You\'re part of them? Feel free to join us!</p></div><div layout="" layout-sm="column" class="field"><md-input-container flex=""><label>Username</label> <input type="text" ng-model="vm.user.username"></md-input-container><p class="errors" ng-show="!!errors.username.length"><span ng-repeat="error in errors.username">Username {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field"><md-input-container flex=""><label>Password</label> <input type="password" ng-model="vm.user.password"></md-input-container><p class="errors" ng-show="!!errors.password.length"><span ng-repeat="error in errors.password">Password {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field"><md-input-container flex=""><label>Email</label> <input type="email" ng-model="vm.user.email"></md-input-container><p class="errors" ng-show="!!errors.email.length"><span ng-repeat="error in errors.email">Email {{ error }}<span ng-if="!$last">,</span></span></p></div></div><md-button class="md-raised md-primary main" ng-click="answer(vm.user)">Sign up</md-button></md-dialog-content><p class="message_below"><span class="message_below_question">Already have an account?</span><md-button class="message_below_link">LOG IN</md-button></p></md-dialog>'),t.put("app/components/search/search.html",'<div class="search_icon"><md-icon md-svg-src="./assets/images/search_icon_white.svg" ng-show="vm.isIconWhite"></md-icon><md-icon md-svg-src="./assets/images/search_icon_black.svg" ng-show="!vm.isIconWhite"></md-icon></div><md-autocomplete md-selected-item="vm.selectedItem" md-selected-item-change="vm.selectedItemChange(item)" md-search-text="vm.searchText" md-search-text-change="vm.searchTextChange(vm.searchText)" md-items="item in vm.querySearch(vm.searchText)" md-item-text="" placeholder="Search" md-delay="400" focus=""><md-item-template><md-icon md-svg-src="{{ item.image }}" class="result_icon"></md-icon><span class="result_name">{{ item.name }}</span> <span class="result_location">{{ item.location }}</span></md-item-template></md-autocomplete>'),t.put("app/components/userProfile/userProfile.html",'<section class="profile_state"><div class="profile_header" layout="row" layout-align="start center"><md-icon md-svg-src="./assets/images/user_details_icon.svg" class="profile_header_avatar"></md-icon><div class="profile_header_content"><div class="profile_header_name">{{ vm.user.username }}</div><div class="profile_header_location"><md-icon md-svg-src="./assets/images/location_icon.svg" class="profile_header_content_avatar"></md-icon><span>{{ vm.user.location }}</span></div><div class="profile_header_url"><md-icon md-svg-src="./assets/images/map_icon.svg" class="profile_header_content_avatar"></md-icon><a ng-href="{{ vm.user.url }}">{{ vm.user.url }}</a></div></div></div><div class="profile_content" layout="row"><div class="profile_sidebar"><p class="profile_sidebar_title">FILTER KITS BY</p><div class="profile_sidebar_options"><md-button ng-click="vm.filterKits(\'all\')" class="profile_sidebar_button">ALL</md-button><md-button ng-click="vm.filterKits(\'online\')" class="profile_sidebar_button">ONLINE</md-button><md-button ng-click="vm.filterKits(\'offline\')" class="profile_sidebar_button">OFFLINE</md-button></div></div><div class="profile_content_main" flex=""><div class="profile_content_main_top"><span class="profile_content_main_title">{{ vm.filteredKits.length }} kits filtering by ALL</span></div><div class="profile_content_main_kits"><div class="kitList" ng-repeat="kit in (vm.filteredKits = (vm.kits | filter: { labels: { status: vm.status } } ))"><div class="kitList_container"><div class=""><md-icon class="kitList_avatar" md-svg-src="{{ kit.avatar }}"></md-icon></div><div class="kitList_content"><div class="kitList_name">{{ kit.name }}</div><div class="kitList_data"><md-icon class="kitList_icon" md-svg-src="./assets/images/location_icon.svg"></md-icon><span>{{ kit.location }}</span><md-icon class="kitList_icon" md-svg-src="./assets/images/sensor_icon.svg"></md-icon><span>{{ kit.type }}</span></div></div></div></div></div></div></div></section>')
}]);