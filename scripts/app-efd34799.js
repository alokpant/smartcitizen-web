!function(){"use strict";angular.module("app.components",["oauth","leaflet-directive","restangular"])}(),function(){"use strict";function t(t,e,n){function a(t){var e={kitName:t.device.name,kitType:o(t),kitLastTime:moment(l(t)).fromNow(),kitLocation:i(t),kitLabels:s(t),kitClass:r(o(t))};return e}function i(t){var e="",n=t.data.location.city,a=t.data.location.country;return n&&(e+=n),a&&(e+=", "+a),e}function s(t){return{status:t.status,exposure:t.data.location.exposure}}function o(t){var e;return new RegExp("sck","i").test(t.kit.name)&&(e="SmartCitizen Kit"),e}function r(t){return t?t.toLowerCase().split(" ").join("_"):""}function l(t){return t.updated_at}function c(t){return moment(t.recorded_at).format("")}function d(t){return moment(t).format("YYYY-MM-DDThh:mm:ss")+"Z"}function u(){}function m(a){var i=n.defer(),s=0,o=[];return a.forEach(function(n,r){t.getDevice(n).then(function(t){o[r]=new e(t,{type:"preview"}),s++,a.length===s&&i.resolve(o)})}),i.promise}var p={parseKit:a,parseKitTime:l,parseSensorTime:c,convertTime:d,getTimeDifferenceInDays:u,getOwnerKits:m};return p}angular.module("app.components").factory("utils",t),t.$inject=["device","Kit","$q"]}(),function(){"use strict";function t(){function t(t,e){if(!e)return t;var n;return"ms"===e?n=t:"s"===e?n=t/1e3:"m"===e?n=t/1e3/60:"h"===e?n=t/1e3/60/60:"d"===e&&(n=t/1e3/60/60/24),n}function e(t){return new Date(t).getTime()}function n(t,e){return moment(e).diff(moment(t),"days")}function a(n,a){var n=e(n);return t(n,a)}function i(){return(new Date).getTime()}function s(){return e(i()-6048e5)}function o(t,e){return t=moment(t),e=moment(e),t.startOf("day").isSame(e.startOf("day"))?!0:!1}var r={getSecondsFromDate:e,getCurrentRange:n,getToday:i,getSevenDaysAgo:s,getDateIn:t,parseTime:a,isSameDay:o};return r}angular.module("app.components").factory("timeUtils",t)}(),function(){"use strict";function t(t){function e(e,n){var a=t.getCurrentRange(e,n,{format:"d"});console.log("rangeD",a);var i;return 1>=a?i="1h":7>=a?i="1h":a>7&&(i="1d"),i}var n={getRollup:e};return n}angular.module("app.components").factory("sensorUtils",t),t.$inject=["timeUtils"]}(),function(){"use strict";function t(t,e,n){function a(){i()}function i(){var t=_.pluck(c.kits,"id");return t.length?void e.getOwnerKits(t).then(function(t){r=t,l.kits=t,console.log("k",r)}):void(l.kits=[])}function s(t){"all"===t&&(t=void 0),l.status=t}function o(){console.log("this")}var r,l=this,c=new t(n);l.status=void 0,l.user=c,l.kits,l.filteredKits,l.filterKits=s,l.goThere=o,a()}angular.module("app.components").controller("UserProfileController",t),t.$inject=["User","utils","userData"]}(),function(){"use strict";function t(){return{scope:{show:"="},restrict:"A",controller:"SignupController",controllerAs:"vm",templateUrl:"app/components/signup/signup.html"}}angular.module("app.components").directive("signup",t)}(),function(){"use strict";function t(t,e){function n(){e.show({hasBackdrop:!0,controller:"SignupDialogController",templateUrl:"app/components/signup/signupModal.html",clickOutsideToClose:!0}).then(function(){})["finally"](function(){})}var a=this;a.showSignup=n,a.errors={}}angular.module("app.components").controller("SignupController",t),t.$inject=["$scope","$mdDialog","user","animation","alert"]}(),function(){"use strict";function t(){function t(){}return{link:t,scope:!0,restrict:"E",templateUrl:"app/components/search/search.html",controller:"SearchController",controllerAs:"vm"}}angular.module("app.components").directive("search",t)}(),function(){"use strict";function t(t,e){function n(){}function a(){}function i(t){return e.globalSearch(t).then(function(t){return 0===t.length?(angular.element(document.body).css("overflow","auto"),t):(angular.element(document.body).css("overflow","hidden"),t.map(function(t){if("Location"!==t.type){var e=s(t),n=o(t);return{type:t.type,name:n,location:e,image:"User"===t.type?"./assets/images/avatar.svg":"./assets/images/kit.svg"}}}))})}function s(t){var e="";return t.city&&(e+=t.city),t.country&&(e+=", "+t.country),e}function o(t){var e="User"===t.type?t.username:t.name;return e?e:"No name"}var r=this;r.searchTextChange=n,r.selectedItemChange=a,r.querySearch=i,r.isIconWhite=!0,t.$on("removeNav",function(){t.$apply(function(){r.isIconWhite=!1})}),t.$on("addNav",function(){t.$apply(function(){r.isIconWhite=!0})})}angular.module("app.components").controller("SearchController",t),t.$inject=["$scope","search"]}(),function(){"use strict";function t(){function t(){}return{link:t,scope:!0,restrict:"E",templateUrl:"app/components/navbar/navbar.html",controller:"NavbarController",controllerAs:"vm"}}angular.module("app.components").directive("navbar",t)}(),function(){"use strict";function t(t,e){function n(){e.logout(),a.isLoggedin=!1}var a=this;a.isShown=!0,a.isLoggedin=!1,a.logout=n,a.dropdownOptions=[{divider:!0,text:"Hello,           "},{text:"PROFILE",value:"1"},{text:"LOGOUT",value:"2"}],a.dropdownSelected,a.dropdownOptionsCommunity=[{text:"Forum",href:"https://forum.smartcitizen.me/"},{text:"Documentation",href:"http://docs.smartcitizen.me/#/"},{text:"API Reference",href:"http://api.smartcitizen.me/"},{text:"Github",href:"https://github.com/fablabbcn/Smart-Citizen-Kit"}],a.dropdownSelectedCommunity,t.$on("removeNav",function(){t.$apply(function(){a.isShown=!1})}),t.$on("addNav",function(){t.$apply(function(){a.isShown=!0})}),t.$on("loggedIn",function(){a.isLoggedin=!0,angular.element("navbar .wrap-dd-menu").css("display","initial"),a.currentUser=e.getCurrentUser().data,a.dropdownOptions[0].text="Hello, "+a.currentUser.username})}angular.module("app.components").controller("NavbarController",t),t.$inject=["$scope","auth"]}(),function(){"use strict";function t(t,e,n,a,i,s,o){function r(){l()}function l(){console.log("aqui");var t=_.pluck(p.kits,"id");return t.length?(console.log("kid",t),void s.getOwnerKits(t).then(function(t){v=t,g.kits=t,console.log("kits",v)})):void(g.kits=[])}function c(t){"all"===t&&(t=void 0),g.kitStatus=t}function d(t){console.log("here",t),"all"===t&&(t=void 0),g.toolType=t}function u(t){a.updateUser(t).then(function(){console.log("done"),g.errors={},o.success("User updated")})["catch"](function(t){o.error("User could not be updated "),g.errors=t.data.errors})}function m(){a.removeUser().then(function(){console.log("removed")})}var p,v,g=this;g.formUser={avatar:null},console.log("auth",e),e&&(p=new n(e,{type:"authUser"}),g.user=p,console.log("vm",g.user),_.defaults(g.formUser,g.user),r()),g.kits,g.kitStatus=void 0,g.filteredKits,g.dropdownSelected,g.dropdownOptions=[{text:"SET UP",value:"1"},{text:"EDIT",value:"2"}],g.tools=[{type:"documentation",title:"How to connect your Smart Citizen Kit tutorial",description:"Adding a Smart Citizen Kit",avatar:"",href:"http://www.google.com"},{type:"documentation",title:"Download the latest SCK Firmware",description:"Github version of the firmware",avatar:""},{type:"documentation",title:"RESTful API Documentation",description:"API Docs",avatar:""},{type:"community",title:"Smart Citizen Forum",description:"Your feedback is important for us",avatar:""},{type:"documentation",title:"SCK Repository Documentation",description:"Fork the project",avatar:""},{type:"social",title:"Like us on Facebook",description:"Follow our news on Facebook",avatar:""},{type:"social",title:"Follow us on Twitter",description:"Discover the weather and your smart connections on Twitter",avatar:""},{type:"social",title:"Be our friend on Google+",description:"Get informed about latest news of Smart Citizen",avatar:""}],g.toolType=void 0,g.filteredTools,g.filterKits=c,g.filterTools=d,g.updateUser=u,g.removeUser=m,t.$on("loggedIn",function(){p=i.getCurrentUser().data,g.user=p,_.defaults(g.formUser,g.user),r()})}angular.module("app.components").controller("MyProfileController",t),t.$inject=["$scope","authUser","User","user","auth","utils","alert"]}(),function(){"use strict";angular.module("app.components")}(),function(){"use strict";function t(t,e,n,a,i,s,o,r){function l(t){return t.map(function(t){return c(t,!1)})}function c(t){return t.icon="offline"===t.status?f.icons.smartCitizenOffline:f.icons.smartCitizenOnline,t.layer="realworld",t}function d(){var t={defaultIcon:{},smartCitizenNormal:{type:"div",className:"marker_normal",iconSize:[12,12]},smartCitizenOnline:{type:"div",className:"marker_online",iconSize:[12,12]},smartCitizenOffline:{type:"div",className:"marker_offline",iconSize:[12,12]}};return t}function u(t){return t}function m(){r.show({hasBackdrop:!0,controller:"MapFilterDialogController",templateUrl:"app/components/map/mapFilterPopup.html",clickOutsideToClose:!0,locals:{filterData:f.filterData}}).then(function(t){_.extend(f.filterData,t),f.markers=v(t)})["finally"](function(){})}function p(t){f.filterData[t]=!1,f.markers=v(f.filterData)}function v(t){return g.filter(function(e){return t[e.myData.labels.status]&&t[e.myData.labels.exposure]})}var g,f=this;console.log("ini",i);var h=u(i[0]);f.icons=d(),g=l(i),f.markers=g,f.currentMarker=o.getCurrentMarker(),f.tiles={url:"https://api.tiles.mapbox.com/v4/mapbox.streets-basic/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoidG9tYXNkaWV6IiwiYSI6ImRTd01HSGsifQ.loQdtLNQ8GJkJl2LUzzxVg"},f.layers={baselayers:{osm:{name:"OpenStreetMap",type:"xyz",url:"https://api.tiles.mapbox.com/v4/mapbox.streets-basic/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoidG9tYXNkaWV6IiwiYSI6ImRTd01HSGsifQ.loQdtLNQ8GJkJl2LUzzxVg"}},overlays:{realworld:{name:"Real world data",type:"markercluster",visible:!0}}},f.center={lat:h.lat,lng:h.lng,zoom:12},f.defaults={scrollWheelZoom:!1},f.events={map:{enable:["dragend","zoomend","moveend","popupopen","popupclose","mousedown","dblclick","click","touchstart"],logic:"broadcast"}},t.$on("leafletDirectiveMap.popupopen",function(t,n){f.center={lat:n.leafletEvent.popup._latlng.lat,lng:n.leafletEvent.popup._latlng.lng,zoom:n.model.center.zoom};var a=n.leafletEvent.popup._source.options.myData.id;e.go("home.kit",{id:a})}),f.filterData={indoor:!0,outdoor:!0,online:!0,offline:!0},f.openFilterPopup=m,f.removeFilter=p}angular.module("app.components").controller("MapController",t),t.$inject=["$scope","$state","$timeout","location","initialMarkers","device","marker","$mdDialog"]}(),function(){"use strict";function t(){return{scope:{show:"="},restrict:"A",controller:"LoginController",controllerAs:"vm",templateUrl:"app/components/login/login.html"}}angular.module("app.components").directive("login",t)}(),function(){"use strict";function t(t,e){function n(){e.show({hasBackdrop:!0,controller:"LoginDialogController",templateUrl:"app/components/login/loginModal.html",clickOutsideToClose:!0}).then(function(){})["finally"](function(){})}t.showLogin=n}angular.module("app.components").controller("LoginController",t),t.$inject=["$scope","$mdDialog","auth","alert"]}(),function(){"use strict";function t(t,e,n,a,i,s,o,r,l,c){function d(){var t=D.kit.owner.kits;i.getOwnerKits(t).then(function(t){D.ownerKits=t})}function u(t){return t.time=moment(i.parseKitTime(t)).fromNow(),t}function m(t){var e=angular.element(".sensors_container"),n=e.scrollLeft(),a=20;console.log("scroll",n),"left"===t?e.scrollLeft(n+a):"right"===t&&e.scrollLeft(n-a)}function p(){return D.sensorsToCompare.filter(function(t){return t.id!==D.selectedSensor})}function v(t,e,n){if(e[0]){if(!I){if(t="date",!n)var n={};n.from=A.getValuePickerFrom(),n.to=A.getValuePickerTo()}"date"===t?(D.loadingChart=!0,g(n.from,n.to).then(function(){D.chartDataMain=f(e)})):"sensor"===t&&(D.chartDataMain=f(e))}}function g(t,e){var a=n.id;return s.getSensorsData(a,t,e).then(function(t){I=t.readings})}function f(t){var e=_(I,t[0]),n={data:e,color:D.selectedSensorData.color,unit:D.selectedSensorData.unit};if(t[1]&&-1!==t[1])var a=_(I,t[1]),i={data:a,color:D.selectedSensorToCompareData.color,unit:D.selectedSensorToCompareData.unit};var s=[n,i];return s}function _(t,e){return 0===t.length?[]:t.map(function(t){var n=t&&t.timestamp,a=t&&t.data[e];return a=null===a?0:a,{time:n,data:a}})}function h(t){var e=t.value;void 0!==e&&("main"===t.type?x=e:"compare"===t.type&&(P=e))}function k(){var t=angular.element(".sensor_icon_selected"),e=t.find(".container_parent");e.css("fill",D.selectedSensorData.color)}function b(){var t=angular.element(".sensor_compare").find("md-select-label").find("span");t.css("color",D.selectedSensorToCompareData.color||"white");var e=angular.element(".sensor_compare").find("md-select-label").find(".md-select-icon");e.css("color","white")}function y(){var t=angular.element(".chart_move_left").find("svg");t.find(".fill_container").css("fill","#03252D");var t=angular.element(".chart_move_right").find("svg");t.find(".fill_container").css("fill","#4E656B")}function w(){var t=angular.element(".kit_time_icon");t.find(".stroke_container").css({"stroke-width":"0.5px",stroke:"#A4B0B3"}),t.find(".fill_container").css("fill","#A4B0B3")}function S(t){return new Date(t).getTime()}function T(){return S(A.getValuePickerTo())-S(A.getValuePickerFrom())}function L(t){var e=T();if("left"===t){var n=A.getValuePickerFrom(),a=S(A.getValuePickerFrom())-e;A.setValuePickers([a,n])}else if("right"===t){var i=c.getToday(),s=A.getValuePickerTo();if(c.isSameDay(i,s))return;var a=A.getValuePickerTo(),n=S(A.getValuePickerTo())+e;A.setValuePickers([a,n])}}function C(){function t(){return S(new Date)}function e(){return S(t()-6048e5)}var n="single",a=$("#picker_from").pickadate({container:"body",klass:{holder:"picker__holder picker_container"}}),i=a.pickadate("picker"),s=$("#picker_to").pickadate({container:"body",klass:{holder:"picker__holder picker_container"}}),o=s.pickadate("picker");return i.get("value")&&o.set("min",i.get("select")),o.get("value")&&i.set("max",o.get("select")),i.on("set",function(t){t.select?(o.get("value")&&"single"===n&&v("date",[x,P],{from:i.get("value"),to:o.get("value")}),o.set("min",i.get("select"))):"clear"in t&&o.set("min",!1)}),o.on("set",function(t){t.select?(i.get("value")&&v("date",[x,P],{from:i.get("value"),to:o.get("value")}),i.set("max",o.get("select"))):"clear"in t&&i.set("max",!1)}),o.set("max",new Date),i.set("select",e()),o.set("select",t()),{getValuePickerFrom:function(){return i.get("value")},setValuePickerFrom:function(t){n="single",i.set("select",t)},getValuePickerTo:function(){return o.get("value")},setValuePickerTo:function(t){n="single",o.set("select",t)},setValuePickers:function(t){var e=t[0],a=t[1];n="pair",i.set("select",e),o.set("select",a)}}}var x,P,I,D=this,A=C();D.goToKit=function(){t.go("home.kit",{id:5})},D.goToUser=function(){t.go("userProfile",{id:1})},D.goToProfile=function(){t.go("myProfile")},D.kitBelongsToUser=l,D.marker=u(a),D.kit=new o(a);var U=D.kit.getSensors({type:"main"});D.battery=U[1],D.sensors=U[0],D.sensorsToCompare=D.kit.getSensors({type:"compare"}),D.slide=m,D.chartData,D.selectedSensor=D.sensors[0].id,D.selectedSensorData={icon:D.sensors[0].icon,value:D.sensors[0].value,unit:D.sensors[0].unit,color:D.sensors[0].color},D.selectedSensorToCompare,D.selectedSensorToCompareData,D.moveChart=L,D.loadingChart=!1,D.dropdownOptions=[{text:"SET UP",value:"1"},{text:"EDIT",value:"2"}],D.dropdownSelected,e.$watch("vm.selectedSensor",function(t){D.selectedSensorToCompare=void 0,D.selectedSensorToCompareData={},D.chartDataCompare=[],P=void 0,D.sensors.forEach(function(e){e.id===t&&(D.selectedSensorData={icon:e.icon,value:e.value,unit:e.unit,color:e.color})}),D.sensorsToCompare=p(),setTimeout(function(){k(),b(),h({type:"main",value:t}),v("sensor",[x,P])},100)}),e.$watch("vm.selectedSensorToCompare",function(t){D.sensorsToCompare.forEach(function(e){e.id===t&&(D.selectedSensorToCompareData={icon:e.icon,color:e.color,unit:e.unit})}),setTimeout(function(){b(),h({type:"compare",value:t}),v("sensor",[x,P])},100)}),e.$on("hideSpinner",function(){D.loadingChart=!1}),setTimeout(function(){k(),y(),w(),d()},1e3)}angular.module("app.components").controller("KitController",t),t.$inject=["$state","$scope","$stateParams","marker","utils","sensor","Kit","$mdDialog","belongsToUser","timeUtils"]}(),function(){"use strict";function t(){}angular.module("app.components").controller("HomeController",t)}(),function(){"use strict";function t(t,e,n,a){t.answer=function(i){n.createUser(i).then(function(t){console.log("data",t),a.success("Signup was successful"),e.hide()})["catch"](function(e){a.error("Signup failed"),console.log("err",e.data.errors),t.errors=e.data.errors})},t.hide=function(){e.hide()},t.cancel=function(){e.cancel()}}angular.module("app.components").controller("SignupDialogController",t),t.$inject=["$scope","$mdDialog","user","alert"]}(),function(){"use strict";function t(t,e,n){t.form={indoor:!1,outdoor:!1,online:!1,offline:!1},_.extend(t.form,n),t.answer=function(n){n||(n=_.each(t.form,function(t,e,n){n[e]=!0})),e.hide(n)},t.hide=function(){e.hide()},t.cancel=function(){e.hide()}}angular.module("app.components").controller("MapFilterDialogController",t),t.$inject=["$scope","$mdDialog","filterData"]}(),function(){"use strict";function t(t,e,n,a){t.answer=function(t){n.login(t).then(function(t){console.log("yes",t);var i=t.access_token;n.saveToken(i),a.success("Signup was successful"),e.hide()})["catch"](function(){console.log("no"),a.error("Username or password incorrect")})},t.hide=function(){e.hide()},t.cancel=function(){e.hide()}}angular.module("app.components").controller("LoginDialogController",t),t.$inject=["$scope","$mdDialog","auth","alert"]}(),function(){"use strict";angular.module("app.components").factory("User",function(){function t(t,e){e&&"authUser"===e.type?(this.username=t.username,this.avatar=t.avatar,this.kits=t.devices,this.city=t.city,this.country=t.country,this.location=t.city&&t.country?t.city+", "+t.country:null,this.url=t.url,this.email=t.email,this.key=t.key,this.macAddress=t.macAddress):(this.username=t.username,this.avatar=t.avatar,this.kits=t.devices,this.location=t.location.city&&t.location.country?t.location.city+", "+t.location.country:null,this.url=t.url)}return t})}(),function(){"use strict";function t(t){var e,n=t.name,a=t.description;return e=new RegExp("custom circuit","i").test(a)?n:new RegExp("noise","i").test(a)?"SOUND":new RegExp("light","i").test(a)?"LIGHT":new RegExp("wifi","i").test(a)?"NETWORKS":new RegExp("co","i").test(a)?"CO":new RegExp("no2","i").test(a)?"NO2":a,e.toUpperCase()}function e(t){var e;switch(t){case"TEMPERATURE":e="°C";break;case"LIGHT":e="LUX";break;case"SOUND":e="DB";break;case"HUMIDITY":case"BATTERY":e="%";break;case"CO":case"NO2":e="KΩ";break;case"NETWORKS":e="#";break;case"SOLAR PANEL":e="V";break;default:e="N/A"}return e}function n(t){var e=t.value;return e?(e=e.toString(),-1!==e.indexOf(".")&&(e=e.slice(0,e.indexOf(".")+3)),e):"N/A"}function a(t){return t.prev_value}function i(t){switch(t){case"TEMPERATURE":return"./assets/images/temperature_icon.svg";case"HUMIDITY":return"./assets/images/humidity_icon.svg";case"LIGHT":return"./assets/images/light_icon.svg";case"SOUND":return"./assets/images/sound_icon.svg";case"CO":return"./assets/images/co_icon.svg";case"NO2":return"./assets/images/no2_icon.svg";case"NETWORKS":return"./assets/images/networks_icon.svg";case"BATTERY":return"./assets/images/battery_icon.svg";case"SOLAR PANEL":return"./assets/images/solar_panel_icon.svg";default:return"./assets/images/avatar.svg"}}function s(t){var e=n(t),i=a(t);return e>i?"./assets/images/arrow_up_icon.svg":i>e?"./assets/images/arrow_down_icon.svg":"./assets/images/equal_icon.svg"}function o(t){switch(t){case"TEMPERATURE":return"#ffc107";case"HUMIDITY":return"#4fc3f7";case"LIGHT":return"#ffee58";case"SOUND":return"#f06292";case"CO":return"#4caf50";case"NO2":return"#8bc34a";case"NETWORKS":return"#9575cd";case"SOLAR PANEL":return"#fff9c4";default:return"black"}}angular.module("app.components").factory("Sensor",function(){function a(a){this.name=t(a),this.id=a.id,this.unit=e(this.name),this.value=n(a),this.icon=i(this.name),this.arrow=s(a),this.color=o(this.name)}return a})}(),function(){"use strict";angular.module("app.components").factory("Marker",["utils","device","COUNTRY_CODES",function(t,e,n){function a(t){var e=i(t);this.lat=t.latitude,this.lng=t.longitude,this.message='<div class="popup"><div class="popup_top '+e.kitClass+'"><p class="popup_name">'+e.kitName+'</p><p class="popup_type">'+e.kitType+'</p><p class="popup_time"><md-icon md-svg-src="./assets/images/update_icon.svg"></md-icon>'+e.kitLastTime+'</p></div><div class="popup_bottom"><p class="popup_location"><md-icon md-svg-src="./assets/images/location_icon.svg"></md-icon>'+e.kitLocation+'</p><div class="popup_labels"><span>'+e.kitLabels.status+"</span><span>"+e.kitLabels.exposure+"</span></div></div></div>",this.myData={id:t.id,labels:e.kitLabels}}function i(t){return{kitName:t.name,kitType:r(t),kitLastTime:moment(c(t)).fromNow(),kitLocation:s(t),kitLabels:o(t),kitClass:l(r(t))}}function s(t){var e="",a=t.city,i=t.country_code,s=n[i];return a&&(e+=a),s&&(e+=", "+s),e}function o(t){return{status:t.status,exposure:t.exposure}}function r(t){var n,a=e.getGenericKitData(),i=a[t.kit_id],s=i&&i.name;return new RegExp("sck","i").test(s)&&(n="SmartCitizen Kit"),n}function l(t){return t?t.toLowerCase().split(" ").join("_"):""}function c(t){return t.added_at}return a}])}(),function(){"use strict";function t(t){var e="",n=t.data.location.city,a=t.data.location.country;return n&&(e+=n),a&&(e+=", "+a),e}function e(t){var e="new"===t.device.status?"offline":t.device.status,n=t.data.location.exposure;return{status:e,exposure:n}}function n(t){var e;return new RegExp("sck","i").test(t.kit.name)&&(e="SmartCitizen Kit"),e}function a(t){return t?t.toLowerCase().split(" ").join("_"):""}function i(t){return t.updated_at}function s(t){return t.kit.name.match(/[0-9]+.?[0-9]*/)[0]}function o(t){return{id:t.owner.id,username:t.owner.username,kits:t.owner.device_ids,location:t.owner.location.city&&t.owner.location.country?t.owner.location.city+", "+t.owner.location.country:null,url:t.owner.url,avatar:t.owner.avatar}}function r(t){var e=l(t),n=a(e);return{name:e,className:n}}function l(){return"Never published"}function c(){return null}angular.module("app.components").factory("Kit",["Sensor",function(l){function d(l,d){d&&"preview"===d.type?(this.id=l.device.id,this.name=l.device.name||"No Name",this.type=n(l),this.location=t(l)||"No location",this.avatar=c(l),this.state=r(l),this.labels=e(l)):(this.name=l.device.name,this.type=n(l),this.version=s(l),this.avatar=c(l),this.lastTime=moment(i(l)).fromNow(),this.location=t(l),this.labels=e(l),this["class"]=a(n(l)),this.id=l.device.id,this.description=l.description,this.owner=o(l),this.data=l.data.sensors)}return d.prototype.getSensors=function(t){var e=this.data.map(function(t){return new l(t)});return"compare"===t.type&&e.unshift({name:"NONE",color:"white",id:-1}),e.reduce(function(e,n,a,i){return"BATTERY"===n.name&&(i.splice(a,1),"main"===t.type?(e[0]=i,e[1]=n):"compare"===t.type&&(e=i)),e},[])},d}])}(),function(){"use strict";angular.module("app.components").constant("COUNTRY_CODES",{AF:"Afghanistan",AX:"Aland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua And Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia And Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, Democratic Republic",CK:"Cook Islands",CR:"Costa Rica",CI:"Cote D'Ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island & Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran, Islamic Republic Of",IQ:"Iraq",IE:"Ireland",IM:"Isle Of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KR:"Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States Of",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territory, Occupied",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts And Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre And Miquelon",VC:"Saint Vincent And Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome And Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia And Sandwich Isl.",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard And Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad And Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks And Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis And Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"})}(),function(){"use strict";function t(t,e){function n(t,n){setTimeout(function(){a(n[0])},1e3),t.$watch("chartData",function(t){if(t&&void 0!==t){if(t[0]&&t[1]){var a=t[0].data,s=a.map(function(t){return{date:w(t.time),count:t&&t.data}});s.sort(function(t,e){return t.date-e.date});var o=t[1].data,r=o.map(function(t){return{date:w(t.time),count:t&&t.data}});r.sort(function(t,e){return t.date-e.date});var l=[s,r],c=[t[0].color,t[1].color],d=[t[0].unit,t[1].unit];i(l,{type:"both",container:n[0],color:c,unit:d})}else if(t[0]){var u=t[0].data,l=u.map(function(t){return{date:w(t.time),count:t&&t.data}});l.sort(function(t,e){return t.date-e.date});var m=t[0].color,p=t[0].unit;i(l,{type:"main",container:n[0],color:m,unit:p})}e.hideSpinner()}})}function a(t){m={top:20,right:15,bottom:20,left:40},p=t.clientWidth-m.left-m.right,v=t.clientHeight-m.top-m.bottom,f=d3.time.scale().range([0,p]),_=d3.scale.linear().range([v,0]),h=d3.scale.linear().range([v,0]),D=d3.scale.linear().range([v,0]),w=d3.time.format.utc("%Y-%m-%dT%H:%M:%SZ").parse,k=d3.svg.axis().scale(f).orient("bottom").ticks(5),b=d3.svg.axis().scale(_).orient("left").ticks(5),y=d3.svg.axis().scale(h).orient("right").ticks(5),S=d3.svg.area().interpolate("linear").x(function(t){return f(t.date)}).y0(v).y1(function(t){return _(t.count)}),T=d3.svg.line().interpolate("linear").x(function(t){return f(t.date)}).y(function(t){return _(t.count)}),L=d3.svg.area().interpolate("linear").x(function(t){return f(t.date)}).y0(v).y1(function(t){return h(t.count)}),C=d3.svg.line().interpolate("linear").x(function(t){return f(t.date)}).y(function(t){return h(t.count)}),g=d3.select(t).append("svg").attr("width",p+m.left+m.right).attr("height",v+m.top+m.bottom).append("g").attr("transform","translate("+(m.left-m.right)+","+m.top+")")}function i(t,e){"main"===e.type?s(t,e):"both"===e.type&&o(t,e)}function s(t,e){function n(){var n=d3.bisector(function(t){return t.date}).left,a=f.invert(d3.mouse(this)[0]),i=n(t,a,1),s=t[i-1],o=t[i],r=a-s.date>o.date-a?o:s;P.attr("transform","translate("+f(r.date)+", "+_(r.count)+")"),I.attr("transform","translate("+(f(r.date)+80)+", "+(d3.mouse(this)[1]-20)+")");var l=I.select("text"),m=l.select(".popup_main"),p=(m.select(".popup_value").text(c(r.count)),m.select(".popup_unit").text(e.unit),l.select(".popup_date").text(d(r.date))),v=[m,p];u(A,v)}f.domain(d3.extent(t,function(t){return t.date})),_.domain([.8*d3.min(t,function(t){return t.count}),1.2*d3.max(t,function(t){return t.count})]),g.selectAll("*").remove();var a=(d3.select(".chart_container svg"),g.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("y1","0%").attr("x1","0%").attr("y2","100%").attr("x2","100%").attr("spreadMethod","pad"));a.append("svg:stop").attr("offset","0%").attr("stop-color","black").attr("stop-opacity",1),a.append("svg:stop").attr("offset","100%").attr("stop-color","white").attr("stop-opacity",1),g.append("path").datum(t).attr("class","chart_area").attr("fill",e.color).attr("d",S),g.append("path").attr("class","chart_line").attr("stroke",e.color).attr("d",T(t)),g.append("g").attr("class","axis x").attr("transform","translate(0,"+v+")").call(k),g.append("g").attr("class","axis y_left").style("fill",e.color).call(b),g.append("g").attr("class","grid").attr("transform","translate(0,"+v+")").call(r().tickSize(-v,0,0).tickFormat("")),g.append("g").attr("class","grid").call(l().tickSize(-p,0,0).tickFormat("")),P=g.append("g").attr("class","focus").style("display","none"),P.append("circle").style("stroke",e.color).attr("r",4.5);var i=84,s=46;I=g.append("g").attr("class","focus").style("display","none"),A=I.append("rect").attr("width",i).attr("height",s).attr("transform",function(){var t="translate(-42, 5)";return t}).style("stroke","grey").style("stroke-width","0.5").style("fill","white");var o=I.append("text").attr("class",""),m=o.append("tspan").attr("class","popup_main").attr("text-anchor","start").attr("x",-i/2).attr("dx",8).attr("y",s/2).attr("dy",3);m.append("tspan").attr("class","popup_value"),m.append("tspan").attr("class","popup_unit").attr("dx",5),o.append("tspan").attr("class","popup_date").attr("x",-i/2).attr("dx",8).attr("y",s-2).attr("dy",0).attr("text-anchor","start"),g.append("rect").attr("class","overlay").attr("width",p).attr("height",v).on("mouseover",function(){I.style("display",null),P.style("display",null)}).on("mouseout",function(){I.style("display","none"),P.style("display","none")}).on("mousemove",n)}function o(t,e){function n(){var n=d3.bisector(function(t){return t.date}).left,a=f.invert(d3.mouse(this)[0]),i=n(t[1],a,1),s=t[1][i-1],o=t[1][i],r=a-s.date>o.date-a?o:s;x.attr("transform","translate("+f(r.date)+", "+h(r.count)+")");var l=t[0][i-1],m=t[0][i],p=a-l.date>m.date-a?m:l;P.attr("transform","translate("+f(p.date)+", "+_(p.count)+")"),I.attr("transform","translate("+(f(r.date)+80)+", "+(d3.mouse(this)[1]-20)+")");var v=I.select("text"),g=v.select(".popup_main");g.select(".popup_value").text(c(p.count)),g.select(".popup_unit").text(e.unit[0]);var k=v.select(".popup_compare");k.select(".popup_value").text(c(r.count)),k.select(".popup_unit").text(e.unit[1]);
var b=v.select(".popup_date").text(d(r.date)),y=[g,k,b];u(A,y)}f.domain(d3.extent(t[0],function(t){return t.date})),_.domain([.8*d3.min(t[0],function(t){return t.count}),1.2*d3.max(t[0],function(t){return t.count})]),h.domain([.8*d3.min(t[1],function(t){return t.count}),1.2*d3.max(t[1],function(t){return t.count})]),g.selectAll("*").remove(),g.append("path").datum(t[0]).attr("class","chart_area").attr("fill",e.color[0]).attr("d",S),g.append("path").datum(t[1]).attr("class","chart_area").attr("fill",e.color[1]).attr("d",L),g.append("path").attr("class","chart_line").attr("stroke",e.color[0]).attr("d",T(t[0])),g.append("path").attr("class","chart_line").attr("stroke",e.color[1]).attr("d",C(t[1])),g.append("g").attr("class","axis x").attr("transform","translate(0,"+v+")").call(k),g.append("g").attr("class","axis y_left").style("fill",e.color[0]).call(b),g.append("g").attr("class","axis y_right").style("fill",e.color[1]).attr("transform","translate("+p+" ,0)").call(y),g.append("g").attr("class","grid").attr("transform","translate(0,"+v+")").call(r().tickSize(-v,0,0).tickFormat("")),g.append("g").attr("class","grid").call(l().tickSize(-p,0,0).tickFormat("")),x=g.append("g").attr("class","focus").style("display","none"),P=g.append("g").attr("class","focus").style("display","none"),x.append("circle").style("stroke",e.color[1]).attr("r",4.5),P.append("circle").style("stroke",e.color[0]).attr("r",4.5);var a=84,i=75;I=g.append("g").attr("class","focus").style("display","none"),A=I.append("rect").attr("width",a).attr("height",i).style("min-width","40px").attr("transform",function(){var t="translate(-42, 5)";return t}).style("stroke","grey").style("stroke-width","0.5").style("fill","white"),I.append("rect").attr("width",8).attr("height",2).attr("transform",function(){return"translate("+(-a/2+4).toString()+", 20)"}).style("fill",e.color[0]),I.append("rect").attr("width",8).attr("height",2).attr("transform",function(){return"translate("+(-a/2+4).toString()+", 45)"}).style("fill",e.color[1]);var s=I.append("text").attr("class",""),o=s.append("tspan").attr("class","popup_main").attr("x",-i/2+7).attr("dx",8).attr("y",i/3).attr("dy",3);o.append("tspan").attr("class","popup_value").attr("text-anchor","start"),o.append("tspan").attr("class","popup_unit").attr("dx",5);var m=s.append("tspan").attr("class","popup_compare").attr("x",-i/2+7).attr("dx",8).attr("y",i/1.5).attr("dy",3);m.append("tspan").attr("class","popup_value").attr("text-anchor","start"),m.append("tspan").attr("class","popup_unit").attr("dx",5),s.append("tspan").attr("class","popup_date").attr("x",-a/2).attr("dx",8).attr("y",i-2).attr("dy",0).attr("text-anchor","start"),g.append("rect").attr("class","overlay").attr("width",p).attr("height",v).on("mouseover",function(){x.style("display",null),P.style("display",null),I.style("display",null)}).on("mouseout",function(){x.style("display","none"),P.style("display","none"),I.style("display","none")}).on("mousemove",n)}function r(){return d3.svg.axis().scale(f).orient("bottom").ticks(5)}function l(){return d3.svg.axis().scale(_).orient("left").ticks(5)}function c(t){if(-1!==t.toString().indexOf(".")){var e=t.toString().split(".");return e[0]+"."+e[1].slice(0,2)}return t.toString().slice(0,2)}function d(t){return moment(t).format("ddd Do MMM YYYY")}function u(t,e){function n(t){return t.node().getBBox()}if(e.length){var a=e.reduce(function(t,e){var a=n(e),i=n(t);return i.width>=a.width?t:e},e[0]),i=2*a.attr("dx");t.attr("width",n(a).width+i)}}var m,p,v,g,f,_,h,k,b,y,w,S,T,L,C,x,P,I,D,A;return{link:n,restrict:"A",scope:{chartData:"="}}}angular.module("app.components").directive("chart",t),t.$inject=["sensor","animation"]}(),function(){"use strict";function t(t,e){function n(t){return e.all("users").post(t)}function a(t){return e.one("users",t).get()}function i(t){return e.all("me").customPUT(t)}function s(){return e.all("me").remove()}var o={createUser:n,getUser:a,updateUser:i,removeUser:s};return o}angular.module("app.components").factory("user",t),t.$inject=["$http","Restangular","auth"]}(),function(){"use strict";function t(t,e,n){function a(){return t.all("sensors").getList()}function i(t){t=t}function s(){return r}function o(a,i,s){var o=n.getRollup(i,s),i=e.convertTime(i),s=e.convertTime(s);return i&&s?(console.log("here",o),t.one("devices",a).customGET("pg_readings",{from:i,to:s,all_intervals:!0,rollup:o})):t.one("devices",a).customGET("pg_readings")}var r;a().then(function(t){console.log("sensors",t.plain()),i(t)});var l={callAPI:a,setTypes:i,getTypes:s,getSensorsData:o};return l}angular.module("app.components").factory("sensor",t),t.$inject=["Restangular","utils","sensorUtils"]}(),function(){"use strict";function t(t,e){function n(t){return e.all("search").getList({q:t})}var a={globalSearch:n};return a}angular.module("app.components").factory("search",t),t.$inject=["$http","Restangular"]}(),function(){"use strict";function t(t){function e(t){i=t}function n(){return i}function a(){t.$broadcast("markerLoaded")}var i,s={setCurrentMarker:e,getCurrentMarker:n,dataLoaded:a};return s}angular.module("app.components").factory("marker",t),t.$inject=["$rootScope"]}(),function(){"use strict";function t(t){function e(){return a().success(function(t){var e=t.loc.split(",");return i={lat:parseFloat(e[0]),lng:parseFloat(e[1])}})}function n(){return i}function a(){return t.jsonp("http://ipinfo.io/?callback=JSON_CALLBACK")}var i;e();var s={getPosition:e,callAPI:a,getPositionObj:n};return s}angular.module("app.components").factory("geolocation",t),t.$inject=["$http"]}(),function(){"use strict";function t(t){function e(e){var n="";return n+=e.lat+","+e.lng,t.all("devices").getList({near:n})}function n(){return t.all("devices/world_map").getList()}function a(e){return t.one("devices",e).get()}function i(){return t.all("kits").getList()}function s(){return o}var o;i().then(function(t){o=_.indexBy(t,"id")});var r={getDevices:e,getAllDevices:n,getDevice:a,getGenericKitData:s};return r}angular.module("app.components").factory("device",t),t.$inject=["Restangular"]}(),function(){"use strict";function t(t,e,n,a,i){function s(){o()}function o(){p.token=e.localStorage.getItem("smartcitizen.token"),p.token&&m().then(function(t){p.data=new i(t,{type:"authUser"}),a.$broadcast("loggedIn"),console.log("user",p)})}function r(){return p}function l(){return!!p.token}function c(t){e.localStorage.setItem("smartcitizen.token",t),o()}function d(t){return n.all("sessions").post(t)}function u(){e.localStorage.removeItem("smartcitizen.token")}function m(){return n.all("").customGET("me")}var p={token:null,data:null};setTimeout(function(){s()},1e3);var v={isAuth:l,setCurrentUser:o,getCurrentUser:r,saveToken:c,login:d,logout:u};return v}angular.module("app.components").factory("auth",t),t.$inject=["$http","$window","Restangular","$rootScope","User"]}(),function(){"use strict";function t(){function t(t,e){t.element=e}function e(t){t.slidePosition=0,t.slideSize=20,this.getTimesSlided=function(){return t.slideSize},this.getPosition=function(){return t.slidePosition*t.slideSize},this.decrementPosition=function(){t.slidePosition-=1},this.incrementPosition=function(){t.slidePosition+=1},this.scrollIsValid=function(e){var n=t.element.scrollLeft();return console.log("scrollpos",n),"left"===e?n>0&&t.slidePosition>=0:"right"===e?300>n:void 0}}return e.$inject=["$scope"],{controller:e,link:t}}function e(){function t(t,e,n,a){var i=angular.element(".sensors_container");e.on("click",function(){a.scrollIsValid("left")&&"left"===n.direction?(a.decrementPosition(),i.scrollLeft(a.getPosition()),console.log(a.getPosition())):a.scrollIsValid("right")&&"right"===n.direction&&(a.incrementPosition(),i.scrollLeft(a.getPosition()),console.log(a.getPosition()))})}return{link:t,require:"^slide-menu",restrict:"A",scope:{direction:"@"}}}angular.module("app.components").directive("slide",e).directive("slideMenu",t),e.$inject=[]}(),function(){"use strict";function t(){function t(t){n=t}function e(){return n}var n,a={setKit:t,getKit:e};return a}angular.module("app.components").factory("layout",t)}(),function(){"use strict";function t(t){function e(){t.$broadcast("blur")}function n(){t.$broadcast("unblur")}function a(){t.$broadcast("removeNav")}function i(){t.$broadcast("addNav")}function s(){t.$broadcast("showSpinner")}function o(){t.$broadcast("hideSpinner")}var r={blur:e,unblur:n,removeNav:a,addNav:i,showSpinner:s,hideSpinner:o};return r}angular.module("app.components").factory("animation",t),t.$inject=["$rootScope"]}(),function(){"use strict";function t(){function t(t,e){t.$watch("moveDown",function(t){t?e.addClass("move_down"):e.removeClass("move_down")})}return{link:t,scope:!1,restrict:"A"}}function e(t,e){function n(n,a){var i=a[0].offsetTop,s=angular.element(".stickNav").height();e(function(){i=a[0].offsetTop,s=angular.element(".stickNav").height()},1e3),angular.element(t).on("scroll",function(){var t=document.body.scrollTop;t+s>=i?(a.addClass("stickMenu"),n.$apply(function(){n.moveDown=!0})):(a.removeClass("stickMenu"),n.$apply(function(){n.moveDown=!1}))})}return{link:n,scope:!1,restrict:"A"}}function n(){function t(t,e){t.$on("blur",function(){e.addClass("blur")}),t.$on("unblur",function(){e.removeClass("blur")})}return{link:t,scope:!1,restrict:"A"}}function a(t){function e(e,n){n.on("focusin",function(){t.removeNav()}),n.on("focusout",function(){t.addNav()});var a=n.find("input");a.on("blur",function(){angular.element(document.body).css("overflow","auto")})}return{link:e}}function i(t,e,n){function a(e,a){{var i=t[0].body.clientHeight,s=angular.element(".stickNav").height();angular.element(".kit_overview").height(),angular.element(".kit_menu").height(),angular.element(".kit_chart").height()}n(function(){var t=angular.element(".kit_overview").height(),e=angular.element(".kit_menu").height(),n=angular.element(".kit_chart").height(),o=i-s-e-t-n;a.css("height",o+"px")})}return{link:a,scope:!0,restrict:"A"}}function s(t,e){function n(t,n){e(function(){{var t=angular.element(".angular-leaflet-map").height(),e=angular.element(".stickNav").height();angular.element(".kit_chart").height()}n.css("margin-top",t+e+"px")})}return{link:n}}angular.module("app.components").directive("moveDown",t).directive("stick",e).directive("blur",n).directive("focus",a).directive("changeMapHeight",i).directive("changeContentMargin",s),t.$inject=[],e.$inject=["$window","$timeout"],a.$inject=["animation"],i.$inject=["$document","layout","$timeout"],s.$inject=["layout","$timeout"]}(),function(){"use strict";function t(t){function e(e,n){function a(t){angular.element(window).scrollTop(t-r.navbar.height-r.kitMenu.height)}function i(t){return l[t]}function s(){var t=angular.element(".md-button.button_active");if(t.length){t.removeClass("button_active");var e=t.find(".stroke_container");e.css("stroke","none"),e.css("stroke-width","1");var n=e.find(".fill_container");n.css("fill","#82A7B0")}}function o(t){var e=angular.element(t);e.addClass("button_active");var n=e.find(".stroke_container");n.css("stroke","white"),n.css("stroke-width","0.01px");var a=n.find(".fill_container");a.css("fill","white")}var r,l=n.children();t(function(){r={navbar:{height:angular.element(".stickNav").height()},kitMenu:{height:angular.element(".kit_menu").height()},kitOverview:{height:angular.element(".kit_overview").height(),offset:angular.element(".kit_overview").offset().top,buttonOrder:0},kitDashboard:{height:angular.element(".kit_chart").height(),offset:angular.element(".kit_chart").offset().top,buttonOrder:1},kitUser:{},kitComments:{}}},1e3);for(var c=0;c<l.length;c++){var d=l[c];angular.element(d).on("click",function(){var t=angular.element(this).index();for(var e in r)if(r[e].buttonOrder===t){var n=r[e].offset;a(n)}})}var u;angular.element(window).on("scroll",function(){var t=document.body.scrollTop,e=t+r.navbar.height+r.kitMenu.height;if("none"!==u&&e<=r.kitOverview.offset){var n=i(r.kitOverview.buttonOrder);s(),u="none"}else if("overview"!==u&&e>=r.kitOverview.offset&&e<=r.kitOverview.offset+r.kitOverview.height){var n=i(r.kitOverview.buttonOrder);s(),o(n),u="overview"}else if("chart"!==u&&e>=r.kitDashboard.offset&&e<=r.kitDashboard.offset+r.kitDashboard.height){var n=i(r.kitDashboard.buttonOrder);s(),o(n),u="chart"}})}return{link:e,restrict:"A"}}angular.module("app.components").directive("activeButton",t),t.$inject=["$timeout"]}(),function(){"use strict";function t(t){function e(t){i("success",t)}function n(t){i("error",t)}function a(t){i("info",t)}function i(e,n,a){a=void 0===a?"top":a,t.show({controller:"AlertController",controllerAs:"vm",templateUrl:"app/components/alert/alert"+e+".html",hideDelay:1e5,position:a,locals:{message:n}})}var s={success:e,error:n,info:a};return s}angular.module("app.components").factory("alert",t),t.$inject=["$mdToast"]}(),function(){"use strict";function t(t,e){function n(){t.hide()}var a=this;a.close=n,a.message=e}angular.module("app.components").controller("AlertController",t),t.$inject=["$mdToast","message"]}(),function(){"use strict";angular.module("app.auth",[])}(),function(){"use strict"}(),angular.module("app",["ngMaterial","ui.router","restangular","angularSpinner","ngDropdowns","app.components","app.auth"]),function(){"use strict";function t(t,e,n,a){t.state("landing",{url:"/",resolve:{location:["geolocation",function(t){var e=t.getPositionObj();return e?e:t.callAPI().then(function(t){var e=t.data.loc.split(","),n={lat:parseFloat(e[0]),lng:parseFloat(e[1])};return n})}],initialMarkers:["$state","device","location",function(t,e,n){return e.getDevices(n).then(function(e){e=e.plain();var n=e[0];t.go("home.kit",{id:n.id})})}]}}).state("home",{url:"","abstract":!0,views:{"":{templateUrl:"app/components/home/template.html"},"map@home":{templateUrl:"app/components/map/map.html",controller:"MapController",controllerAs:"vm"}},resolve:{location:["geolocation",function(t){return t.callAPI().then(function(t){var e=t.data.loc.split(","),n={lat:parseFloat(e[0]),lng:parseFloat(e[1])};return n})}],sensorTypes:["sensor",function(t){return t.callAPI().then(function(t){return t=t.plain()})}],initialMarkers:["$state","device","location","utils","sensorTypes","Kit","Marker",function(t,e,n,a,i,s,o){return e.getAllDevices().then(function(t){return t.map(function(t){return new o(t)})})}]}}).state("home.kit",{url:"/kits/:id",views:{"container@home":{templateUrl:"app/components/kit/kit.html",controller:"KitController",controllerAs:"vm"}},resolve:{marker:["$stateParams","device","marker",function(t,e,n){return e.getDevice(t.id).then(function(t){return t=t.plain(),n.setCurrentMarker(t),n.dataLoaded(),t})}],belongsToUser:["$stateParams","auth","marker",function(t,e){if(!e.isAuth())return!1;var n=t.id,a=e.getCurrentUser().data.kits;return _.some(a,function(t){return n===t.id})}]}}).state("userProfile",{url:"/users/:id",templateUrl:"app/components/userProfile/userProfile.html",controller:"UserProfileController",controllerAs:"vm",resolve:{userData:["$stateParams","user",function(t,e){var n=t.id;return e.getUser(n).then(function(t){return t})}]}}).state("myProfile",{url:"/profile",authenticate:!0,templateUrl:"app/components/myProfile/myProfile.html",controller:"MyProfileController",controllerAs:"vm",resolve:{authUser:["user","auth",function(t,e){var n=e.getCurrentUser().data;return console.log("u",n),n?n:void 0}]}}),e.otherwise("/"),n.html5Mode({enabled:!0,requireBase:!1}).hashPrefix("!"),a.setBaseUrl("https://new-api.smartcitizen.me/v0")}angular.module("app").config(t),t.$inject=["$stateProvider","$urlRouterProvider","$locationProvider","RestangularProvider"]}(),function(){"use strict";function t(t,e,n){t.$on("$stateChangeStart",function(){}),e.addFullRequestInterceptor(function(t,e,a,i,s,o,r){if(n.isAuth()){var l=n.getCurrentUser().token;s.Authorization="Bearer "+l}return{element:t,headers:s,params:o,httpConfig:r}})}angular.module("app").run(t),t.$inject=["$rootScope","Restangular","auth","$templateCache"]}(),angular.module("app").run(["$templateCache",function(t){t.put("app/components/alert/alerterror.html",'<md-toast class="red"><md-icon md-svg-src="./assets/images/alert_icon.svg" alt="Insert Drive Icon" class="alert_icon"></md-icon><span flex="">{{ vm.message }}</span><md-button ng-click="vm.close()"><md-icon md-svg-src="./assets/images/close_icon_black.svg" alt="Insert Drive Icon" class="close_icon"></md-icon></md-button></md-toast>'),t.put("app/components/alert/alertinfo.html",'<md-toast class="blue"><md-icon md-svg-src="./assets/images/alert_icon.svg" alt="Insert Drive Icon" class="alert_icon"></md-icon><span flex="">{{ vm.message }}</span><md-button ng-click="vm.close()"><md-icon md-svg-src="./assets/images/close_icon_black.svg" alt="Insert Drive Icon" class="close_icon"></md-icon></md-button></md-toast>'),t.put("app/components/alert/alertsuccess.html",'<md-toast class="green"><md-icon md-svg-src="./assets/images/alert_icon.svg" alt="Insert Drive Icon" class="alert_icon"></md-icon><span flex="">{{ vm.message }}</span><md-button ng-click="vm.close()"><md-icon md-svg-src="./assets/images/close_icon_black.svg" alt="Insert Drive Icon" class="close_icon"></md-icon></md-button></md-toast>'),t.put("app/components/home/home.html",'<div layout="vertical" layout-fill=""><md-content><section class="content"><section class="map"><h1>Here\'s the map</h1></section><section class="kit_data"><section class="kit_menu" layout="row" layout-align="center center" stick=""><p>Bar with kit info</p></section><section class="kit_fixed" move-down=""><section class="kit_overview" layout="row" layout-align="center center"><p>Kit data overview</p></section><section class="kit_detailed" layout="row" layout-align="center center"><section class="kit_chart"><p>Here it\'s the data</p></section></section></section></section></section></md-content></div>'),t.put("app/components/home/template.html",'<div layout="vertical" layout-fill=""><md-content><section class="content"><div ui-view="map" class="map_state"></div><div ui-view="container" class="kit"></div></section></md-content></div>'),t.put("app/components/kit/kit.html",'<section class="kit_data" change-content-margin=""><section class="kit_menu" layout="row" layout-align="center center" stick=""><div class="container"><div class="kit_user"><md-icon md-svg-src="{{ vm.marker.owner.avatar || \'./assets/images/avatar.svg\'}}"></md-icon><span>{{ vm.marker.owner.username}}</span></div><div class="kit_name"><md-icon md-svg-src="./assets/images/sensor_icon.svg"></md-icon><span>{{ vm.marker.device.name }}</span></div><div class="kit_battery"><md-icon md-svg-src="{{ vm.battery.icon }}"></md-icon><span>{{ vm.battery.value }} {{ vm.battery.unit }}</span></div><div class="kit_navbar" active-button=""><md-button href="#" class="md-flat chart_icon" aria-label=""><md-icon md-svg-src="./assets/images/chart_icon.svg"></md-icon></md-button><md-button href="#" class="md-flat kit_details_icon" aria-label=""><md-icon md-svg-src="./assets/images/kit_details_icon.svg"></md-icon></md-button><md-button href="#" class="md-flat user_details" aria-label=""><md-icon md-svg-src="./assets/images/user_details_icon.svg"></md-icon></md-button></div></div></section><section class="kit_fixed" move-down=""><section class="kit_overview"><md-button ng-click="vm.slide(\'right\')" class="md-flat button_scroll button_scroll_left" layout="column" layout-align="center center" aria-label=""><md-icon md-svg-src="./assets/images/arrow_left_icon.svg"></md-icon></md-button><div class="sensors_container" layout="row" layout-align="center center"><div ng-repeat="sensor in vm.sensors" class="sensor_container"><md-icon md-svg-src="{{ sensor.icon }}" class="sensor_icon"></md-icon><div class="sensor_value">{{ sensor.value }}</div><div class="sensor_right"><div class="sensor_unit">{{ sensor.unit }}</div><md-icon md-svg-src="{{ sensor.arrow }}" class="sensor_arrow"></md-icon></div><div class="clear"></div><div class="sensor_name">{{ sensor.name }}</div></div></div><md-button ng-click="vm.slide(\'left\')" class="md-flat button_scroll button_scroll_right" layout="column" layout-align="center center" aria-label=""><md-icon md-svg-src="./assets/images/arrow_right_icon.svg"></md-icon></md-button></section><section class="kit_detailed"><section class="kit_chart"><div class="container" layout="row"><div class="kit_chart_left"><div class="sensor_select"><md-icon md-svg-src="{{ vm.selectedSensorData.icon }}" class="sensor_icon_selected"></md-icon><md-select placeholder="Choose sensor" ng-model="vm.selectedSensor"><md-option ng-repeat="sensor in vm.sensors" ng-value="{{sensor.id}}" ng-selected="$first"><img class="select_image" src="{{ sensor.icon }}"> <span>{{ sensor.name }}</span></md-option></md-select></div><div class="sensor_data"><span class="sensor_value">{{ vm.selectedSensorData.value }}<span><span class="sensor_unit">{{ vm.selectedSensorData.unit }}</span></span></span></div><div class="sensor_description"><h6>{{ vm.sensors[vm.selectedSensor].name }}</h6><p>Lorep ipsum Lorep ipsumLorep ipsumLorep ipsumLorep ipsumLorep ipsumLorep ipsum <a href="#">More info</a></p></div><div class="sensor_compare"><p><span>Compare with</span><md-select placeholder="NONE" ng-model="vm.selectedSensorToCompare"><md-option ng-repeat="sensor in vm.sensorsToCompare" ng-value="{{sensor.id}}"><img class="select_image" src="{{ sensor.icon }}"> <span class="sensor_name">{{ sensor.name }}</span></md-option></md-select></p></div></div><div class="kit_chart_right" flex=""><div class="chart_navigation"><div class="kit_time"><md-icon class="kit_time_icon" md-svg-src="./assets/images/update_icon.svg"></md-icon>{{ vm.marker.time }}</div><div class="picker_container"><label for="picker_from">From:</label> <input type="text" id="picker_from" class="date_picker" placeholder="FROM"></div><div class="picker_container"><label for="picker_to">To:</label> <input type="text" id="picker_to" class="date_picker" placeholder="TO"></div><div class="chart_move"><md-button href="#" ng-click="vm.moveChart(\'left\')" class="chart_move_button chart_move_left" aria-label=""><md-icon md-svg-src="./assets/images/arrow_left_icon.svg"></md-icon></md-button><md-button href="#" ng-click="vm.moveChart(\'right\')" class="chart_move_button chart_move_right" aria-label=""><md-icon md-svg-src="./assets/images/arrow_right_icon.svg"></md-icon></md-button></div></div><div style="clear: both"></div><div chart="" class="chart_container" chart-data="vm.chartDataMain"><md-progress-circular ng-show="vm.loadingChart" class="md-hue-3 chart_spinner" md-mode="indeterminate"></md-progress-circular></div></div></div></section><section class="kit_details"><div class="kit_detailed_content_container"><div class="kit_detailed_title_container"><md-icon class="kit_detailed_icon_title" md-svg-src="./assets/images/kit_details_icon.svg"></md-icon><h2 class="kit_detailed_title">KIT DETAILS</h2></div><div class="kit_detailed_content_container" layout="row"><div class="kit_detailed_avatar"><md-icon md-svg-src="{{ vm.kit.avatar || \'./assets/images/avatar.svg\' }}"></md-icon></div><div class="kit_details_content_main" flex=""><div class="kit_details_content"><h3 class="kit_detailed_name kit_details_name">{{ vm.kit.name }}</h3><p class="kit_details_location"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/location_icon.svg"></md-icon><span>{{ vm.kit.location }}</span></p><p class="kit_details_type"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/kit_details_icon.svg"></md-icon><span>{{ vm.kit.type }}</span> <span class="kit_details_version"><span>SCK:</span> {{ vm.kit.version }}</span> <span class="kit_details_id"><span>ID:</span> {{ vm.kit.id }}</span></p><p class="kit_details_lastTime"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/update_icon.svg"></md-icon><span>{{ vm.kit.lastTime }}</span></p><p class="kit_details_labels"><span ng-repeat="label in vm.kit.labels">{{ label }}</span></p><div class="kit_details_description"><h4 class="kit_details_description_title">Kit Description:</h4><p class="kit_details_description_content">{{ vm.kit.description || \'No data\' }}</p></div></div></div><div class="kit_details_manage" ng-if="vm.kitBelongsToUser" flex=""><div class="kit_details_manage_buttons"><md-button href="#" ng-click="" class="kit_details_button_setup" aria-label="">SET UP</md-button><md-button href="#" ng-click="" class="kit_details_button_edit" aria-label="">EDIT</md-button><md-button href="#" ng-click="" class="kit_details_button_delete" aria-label="">DELETE</md-button></div><div class="kit_details_manage_data"><div class="kit_details_macaddress"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/mac_address_icon.svg"></md-icon><span class="kit_details_manage_data_name">Mac Address:</span> <span>00:00:00:00:01</span></div><div class="kit_details_debug"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/debug_icon.svg"></md-icon><span class="kit_details_manage_data_name">Debug mode:</span> <span>Enabled</span></div><div class="kit_details_key"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/key_icon.svg"></md-icon><span class="kit_details_manage_data_name">API Key:</span> <span>34334324233d3f4f3</span></div><div class="kit_details_download"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/download_icon.svg"></md-icon><span class="kit_details_manage_data_name">Download Data</span> <span>Choose your format</span></div></div></div><div class="kit_details_notAuth" ng-if="!vm.kitBelongsToUser" flex=""><h3 class="kit_details_notAuth_title">People looking for a better city</h3><small class="kit_details_notAuth_subheader">You\'re part of them? Feel free to join us!</small><p class="kit_details_notAuth_description">Smart Citizen is a a platform to generate participatory processes of the people in the cities. Connecting data, people and knowledge, the objective of the platform is to serve as a node for building productive open indicators and distributed tools, and thereafter the collective construction of the city for its own inhabitants.</p><md-button class="kit_details_notAuth_button">GET YOUR KIT AND JOIN US</md-button></div></div></div></section><section class="kit_owner"><div class="kit_detailed_content_container"><div class="kit_detailed_title_container"><md-icon class="kit_detailed_icon_title" md-svg-src="./assets/images/user_details_icon.svg"></md-icon><h2 class="kit_detailed_title">KIT OWNER</h2></div><div class="kit_detailed_content_container"><div class="kit_detailed_avatar"><md-icon md-svg-src="{{ vm.kit.owner.avatar || \'./assets/images/avatar.svg\' }}"></md-icon></div><div class="kit_owner_content"><div class="kit_owner_info"><a href="./users/{{vm.kit.owner.id}}" class="kit_owner_usernameLink"><h3 class="kit_owner_usernameText">{{ vm.kit.owner.username }}</h3></a><p class="kit_owner_location"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/location_icon.svg"></md-icon><span>{{ vm.kit.owner.location || \'No location\' }}</span></p><p class="kit_owner_url"><md-icon class="kit_detailed_icon_content" md-svg-src="./assets/images/user_details_icon.svg"></md-icon><a ng-href="{{ vm.kit.owner.url }}">{{ vm.kit.owner.url || \'No URL\'}}</a></p></div><div class="kit_owner_kits"><h3 class="kit_owner_kits_title">Kits of {{ vm.kit.owner.username }}<h3><div class="kitList_parent" ng-repeat="kit in vm.ownerKits | limitTo: 5"><md-button ng-href="./kits/{{kit.id}}" class="kitList kitList_secondary" ng-class="{kitList_primary: !vm.kitBelongsToUser, kitList_secondary: vm.kitBelongsToUser, kitList_borderBottom: $last}" layout="row" layout-align="start center"><div class="kitList_container" layout="row" layout-align="start center"><div class=""><md-icon class="kitList_avatar" md-svg-src="{{ kit.avatar || \'./assets/images/avatar.svg\' }}"></md-icon></div><div class="kitList_content"><p class="kitList_name">{{ kit.name }}</p><p class="kitList_data"><md-icon class="kitList_icon" md-svg-src="./assets/images/location_icon.svg"></md-icon><span>{{ kit.location}}</span><md-icon class="kitList_icon" md-svg-src="./assets/images/sensor_icon.svg"></md-icon><span>{{ kit.type }}</span></p></div><div class="kitList_state kitList_state_{{ kit.state.className }}" ng-if="vm.kitBelongsToUser">{{ kit.state.name }}</div></div></md-button><div class="kitList_config" ng-if="vm.kitBelongsToUser"><md-button class="kitList_dropdownButton" dropdown-menu="vm.dropdownOptions" dropdown-model="vm.dropdownSelected" dropdown-item-label="text"><img src="./assets/images/config_icon.svg"></md-button></div></div><md-button href="#" ng-if="vm.ownerKits.length > 5" ng-click="" class="kit_owner_kits_more_button" aria-label="">VIEW ALL KITS OF {{ vm.kit.owner.username }}</md-button></h3></h3></div></div></div></div><div class="clearfix"></div></section><md-button ng-click="vm.goToUser()">User 1</md-button><md-button ng-click="vm.goToProfile()">Profile</md-button></section></section></section>'),t.put("app/components/login/login.html",'<md-button class="md-flat full_height" ng-click="showLogin($event)">Log In</md-button>'),t.put("app/components/login/loginModal.html",'<md-dialog><md-dialog-content class="modal modal_login"><md-button class="close_icon"><md-icon md-svg-icon="./assets/images/close_icon_blue.svg" ng-click="hide()" class=""></md-icon></md-button><form name="signup_form" novalidate="" ng-submit="answer(vm.user)"><div class="modal_content_container"><h2>LOG IN</h2><div class="modal_message"><p class="header">People looking for a better city</p><p class="subheader">You\'re part of them? Feel free to join us!</p></div><div layout="" layout-sm="column" class="field"><md-input-container flex=""><label>Username</label> <input type="text" name="username" ng-model="vm.user.username" required=""></md-input-container><p class="errors" ng-show="signup_form.$submitted || signup_form.username.$touched"><span ng-show="signup_form.username.$error.required">Username is required</span></p></div><div layout="" layout-sm="column" class="field"><md-input-container flex=""><label>Password</label> <input type="password" name="password" ng-model="vm.user.password" required=""></md-input-container><p class="errors" ng-show="signup_form.$submitted || signup_form.password.$touched"><span ng-show="signup_form.password.$error.required">Password is required</span></p></div></div><md-button class="md-flat md-primary main" type="submit">LOG IN</md-button></form></md-dialog-content><p class="message_below"><span><span class="message_below_question">New here?</span><md-button class="message_below_link">SIGN IN</md-button></span> <span><span>Forgot your password?</span><md-button>REQUEST</md-button></span></p></md-dialog>'),t.put("app/components/map/map.html",'<section class="map" change-map-height=""><leaflet center="vm.center" layers="vm.layers" markers="vm.markers" defaults="vm.defaults" event-broadcast="vm.events" width="100%" height="100%"></leaflet><div class="map_legend"><md-button ng-click="vm.openFilterPopup()"><md-icon md-svg-src="./assets/images/close_icon_black.svg"></md-icon></md-button><div class="map_filters"><div ng-repeat="(filterName, isFilterSelected) in vm.filterData" class="map_filter" ng-if="isFilterSelected" layout="row" layout-align="center center"><span class="map_filter_name">{{ filterName }}</span> <button class="map_filter_icon"><md-icon ng-click="vm.removeFilter(filterName)" md-svg-src="./assets/images/close_icon_black.svg"></md-icon></button></div></div></div></section>'),t.put("app/components/map/mapFilterPopup.html",'<md-dialog><md-dialog-content class="modal modal_mapFilter"><md-button class="close_icon"><md-icon md-svg-icon="./assets/images/close_icon_blue.svg" ng-click="cancel()" class=""></md-icon></md-button><div class="modal_content_container"><h2>FILTERS</h2><div class="modal_message"><p class="message">You can apply some filters to get more accurate results on the map.</p></div><div class="input_filter"><h3>Location filter</h3><small>now showing indoor</small><md-checkbox ng-model="form.indoor" aria-label=""></md-checkbox><span>Indoor</span><md-checkbox ng-model="form.outdoor" aria-label=""></md-checkbox><span>Outdoor</span></div><md-divider></md-divider><div class="input_filter"><h3>Status filter</h3><small>now showing online</small><md-checkbox ng-model="form.online" aria-label=""></md-checkbox><span>Online</span><md-checkbox ng-model="form.offline" aria-label=""></md-checkbox><span>Offline</span></div><md-divider></md-divider></div><md-button class="md-flat button_clear" ng-click="answer()">CLEAR FILTERS</md-button><md-button class="md-flat md-primary main" ng-click="answer(form)">APPLY</md-button></md-dialog-content></md-dialog>'),t.put("app/components/myProfile/myProfile.html",'<section class="myProfile_state"><div class="profile_header myProfile_header"><div class="myProfile_header_container" layout="row"><md-icon md-svg-src="./assets/images/user_details_icon.svg" class="profile_header_avatar myProfile_header_avatar"></md-icon><div class="profile_header_content"><div class="profile_header_name">{{ vm.user.username || \'No data\' }}</div><div class="profile_header_location"><md-icon md-svg-src="./assets/images/location_icon.svg" class="profile_header_content_avatar"></md-icon><span>{{ vm.user.location || \'No data\' }}</span></div><div class="profile_header_url"><md-icon md-svg-src="./assets/images/url_icon.svg" class="profile_header_content_avatar"></md-icon><a ng-href="{{ vm.user.url || \'http://example.com\' }}">{{ vm.user.url || \'No data\' }}</a></div></div></div></div><div class="myProfile_tabs_parent"><md-tabs class="myProfile_tabs" md-center-tabs="true"><md-tab label=""><md-tab-label><md-icon md-svg-src="./assets/images/user_details_icon.svg" class="myProfile_tab_icon"></md-icon><span>PROFILE</span></md-tab-label><md-tab-body><div class="profile_content" layout="row"><div class="profile_sidebar"><p class="profile_sidebar_title">EDIT YOUR PROFILE</p><p class="profile_sidebar_description">A complete profile helps us to bring to you a better experience. Please, take your time completing all fields.</p><md-button ng-click="" class="profile_sidebar_button"><md-icon md-svg-src="./assets/images/location_icon.svg" class="profile_sidebar_avatar"></md-icon><span>Support</span></md-button><md-button ng-click="" class="profile_sidebar_button"><md-icon md-svg-src="./assets/images/location_icon.svg" class="profile_sidebar_avatar"></md-icon><span>Community</span></md-button></div><div class="profile_content_main" flex=""><div class="myProfile_content_form"><div class="myProfile_form_avatar"><md-icon md-svg-src="{{ vm.user.avatar }}" class="myProfile_tab_icon"></md-icon></div><div layout="" layout-sm="column" class="field myProfile_content_form_input"><md-input-container flex=""><label>Username</label> <input type="text" ng-model="vm.formUser.username"></md-input-container><p class="myProfile_updateForm_error" ng-show="!!vm.errors.username.length"><span ng-repeat="error in vm.errors.username">Username {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field myProfile_content_form_input"><md-input-container flex=""><label>Password</label> <input type="password" ng-model="vm.formUser.password"></md-input-container><p class="myProfile_updateForm_error" ng-show="!!vm.errors.password.length"><span ng-repeat="error in vm.errors.password">Password {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field myProfile_content_form_input"><md-input-container flex=""><label>Email</label> <input type="email" ng-model="vm.formUser.email"></md-input-container><p class="myProfile_updateForm_error" ng-show="!!vm.errors.email.length"><span ng-repeat="error in vm.errors.email">Email {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field myProfile_content_form_input"><md-input-container flex=""><label>City</label> <input type="text" ng-model="vm.formUser.city"></md-input-container><p class="myProfile_updateForm_error" ng-show="!!vm.errors.city.length"><span ng-repeat="error in vm.errors.city">City {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field myProfile_content_form_input"><md-input-container flex=""><label>Country</label> <input type="text" ng-model="vm.formUser.country"></md-input-container><p class="myProfile_updateForm_error" ng-show="!!vm.errors.country.length"><span ng-repeat="error in vm.errors.country">Country {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field myProfile_content_form_input"><md-input-container flex=""><label>Website</label> <input type="text" ng-model="vm.formUser.url"></md-input-container><p class="myProfile_updateForm_error" ng-show="!!vm.errors.url.length"><span ng-repeat="error in vm.errors.url">URL {{ error }}<span ng-if="!$last">,</span></span></p></div><md-button ng-click="vm.updateUser(vm.formUser)" class="myProfile_form_updateButton">UPDATE PROFILE</md-button><div class="clearfix"></div><div class="myProfile_apiKey"><md-icon md-svg-src="./assets/images/user_details_icon.svg" class="myProfile_tab_icon"></md-icon><span>API KEY</span></div><md-button ng-click="vm.removeUser()" class="myProfile_form_removeButton">DELETE ACCOUNT</md-button><small>Delete your profile will erase all your data. Please consider think twice before click this button.</small></div></div></div></md-tab-body></md-tab><md-tab label=""><md-tab-label><md-icon md-svg-src="./assets/images/kit_details_icon.svg" class="myProfile_tab_icon"></md-icon><span>KITS</span></md-tab-label><md-tab-body><div class="profile_content" layout="row"><div class="profile_sidebar"><p class="profile_sidebar_title">FILTER KITS BY</p><div class="profile_sidebar_options"><md-button ng-click="vm.filterKits(\'all\')" class="profile_sidebar_button">ALL</md-button><md-button ng-click="vm.filterKits(\'online\')" class="profile_sidebar_button">ONLINE</md-button><md-button ng-click="vm.filterKits(\'offline\')" class="profile_sidebar_button">OFFLINE</md-button></div></div><div class="profile_content_main" flex=""><div class="profile_content_main_top"><md-button class="myProfile_addKitButton">ADD A NEW KIT</md-button><span class="myProfile_content_main_title">{{ vm.filteredKits.length || 0 }} kits filtering by {{ vm.kitStatus.toUpperCase() || \'ALL\' }}</span></div><div class="kitList_parent" ng-repeat="kit in (vm.filteredKits = (vm.kits | filter: { labels: { status: vm.kitStatus } } ))"><md-button ng-href="./kits/{{kit.id}}" class="kitList kitList_secondary" ng-class="{kitList_borderBottom: $last}"><div class="kitList_container" layout="row" layout-align="start center"><div class=""><md-icon class="kitList_avatar" md-svg-src="{{ kit.avatar || \'./assets/images/avatar.svg\' }}"></md-icon></div><div class="kitList_content"><div class="kitList_name">{{ kit.name }}</div><div class="kitList_data"><md-icon class="kitList_icon" md-svg-src="./assets/images/location_icon.svg"></md-icon><span>{{ kit.location }}</span><md-icon class="kitList_icon" md-svg-src="./assets/images/sensor_icon.svg"></md-icon><span>{{ kit.type }}</span></div></div><div class="kitList_state kitList_state_{{ kit.state.className }}">{{ kit.state.name }}</div></div></md-button><div class="kitList_config" layout="row"><md-button class="kitList_dropdownButton" dropdown-menu="vm.dropdownOptions" dropdown-model="vm.dropdownSelected" dropdown-item-label="text"><img src="./assets/images/config_icon.svg"></md-button></div></div><div class="kitList kitList_primary kitList_borderBottom" ng-show="!vm.kits.length"><div class="kitList_container"><div class="kitList_noKits"><span>There are not kits yet</span></div></div></div></div></div></md-tab-body></md-tab><md-tab label=""><md-tab-label><md-icon md-svg-src="./assets/images/user_details_icon.svg" class="myProfile_tab_icon"></md-icon><span>TOOLS</span></md-tab-label><md-tab-body><div class="profile_content" layout="row"><div class="profile_sidebar"><p class="profile_sidebar_title">FILTER TOOLS BY</p><div class="profile_sidebar_options"><md-button ng-click="vm.filterTools(\'all\')" class="profile_sidebar_button">ALL</md-button><md-button ng-click="vm.filterTools(\'documentation\')" class="profile_sidebar_button">DOCUMENTATION</md-button><md-button ng-click="vm.filterTools(\'community\')" class="profile_sidebar_button">COMMUNITY</md-button><md-button ng-click="vm.filterTools(\'social\')" class="profile_sidebar_button">SOCIAL</md-button></div></div><div class="profile_content_main" flex=""><div class="profile_content_main_top"><span class="profile_content_main_title">{{ vm.filteredTools.length || 0 }} kits filtering by {{ vm.toolType.toUpperCase() || \'ALL\' }}</span></div><div class="profile_content_main_kits"><div ng-repeat="tool in (vm.filteredTools = (vm.tools | filter: { type: vm.toolType } ))" ng-class="{kitList_borderBottom: $last}"><md-button ng-href="{{tool.href}}" class="kitList kitList_primary" layout="row" layout-align="start center"><div class="kitList_container" layout="row" layout-align="start center"><div class=""><md-icon class="kitList_avatar" md-svg-src="{{ tool.avatar || \'./assets/images/user_details_icon.svg\'}}"></md-icon></div><div class="kitList_content"><div class="kitList_name">{{ tool.title }}</div><div class="kitList_data"><span>{{ tool.description }}</span></div></div></div></md-button></div></div></div></div></md-tab-body></md-tab></md-tabs></div></section>'),t.put("app/components/navbar/navbar.html",'<md-toolbar layout="row" layout-align="end center" class="stickNav"><a href="/" class="logo_link"><md-icon md-svg-src="./assets/images/LogotipoSmartCitizen.svg" alt="Insert Drive Icon" class="logo_icon"></md-icon></a><section layout="row" class="nav_left" layout-align="space-around center"><md-button ng-show="vm.isShown" href="#" class="md-flat full_height map"><md-icon md-svg-src="./assets/images/map_icon.svg" class="nav_icon"></md-icon><span>Map</span></md-button><md-button ng-show="vm.isShown" href="" class="md-flat full_height community" aria-label="" dropdown-menu="vm.dropdownOptionsCommunity" dropdown-model="vm.dropdownSelectedCommunity" dropdown-item-label="text" layout="row" layout-align="center center"><md-icon md-svg-src="./assets/images/community_icon.svg" class="nav_icon"></md-icon><span>Community</span></md-button></section><search flex=""></search><section layout="row" class="nav_right" layout-align="space-around center"><md-button ng-show="vm.isShown" href="#" class="md-flat full_height get" ng-class="{navbar_highlight_button: vm.isLoggedin}">Get your Kit</md-button><div ng-show="vm.isShown && !vm.isLoggedin" login="" class="navbar_login_button md-display-1"></div><div ng-show="vm.isShown && !vm.isLoggedin" signup="" class="navbar_signup_button md-display-1"></div><md-button ng-show="vm.isShown && vm.isLoggedin" href="" class="md-flat navbar_avatar_button" aria-label="" dropdown-menu="vm.dropdownOptions" dropdown-model="vm.dropdownSelected" dropdown-item-label="text"><md-icon class="navbar_avatar_icon" md-svg-src="{{ vm.currentUser.avatar || \'./assets/images/avatar.svg\' }}"></md-icon></md-button></section></md-toolbar>'),t.put("app/components/search/search.html",'<div class="search_icon"><md-icon md-svg-src="./assets/images/search_icon_white.svg" ng-show="vm.isIconWhite"></md-icon><md-icon md-svg-src="./assets/images/search_icon_black.svg" ng-show="!vm.isIconWhite"></md-icon></div><md-autocomplete md-selected-item="vm.selectedItem" md-selected-item-change="vm.selectedItemChange(item)" md-search-text="vm.searchText" md-search-text-change="vm.searchTextChange(vm.searchText)" md-items="item in vm.querySearch(vm.searchText)" md-item-text="" placeholder="Search" md-delay="400" focus=""><md-item-template><md-icon md-svg-src="{{ item.image }}" class="result_icon"></md-icon><span class="result_name">{{ item.name }}</span> <span class="result_location">{{ item.location }}</span></md-item-template></md-autocomplete>'),t.put("app/components/signup/signup.html",'<md-button class="md-icon-button" ng-click="vm.showSignup($event)">Sign Up</md-button>'),t.put("app/components/signup/signupModal.html",'<md-dialog><md-dialog-content class="modal signup"><md-button class="close_icon"><md-icon md-svg-icon="./assets/images/close_icon_blue.svg" ng-click="cancel()" class=""></md-icon></md-button><div class="modal_content_container"><h2>SIGN UP</h2><div class="modal_message"><p class="header">People looking for a better city</p><p class="subheader">You\'re part of them? Feel free to join us!</p></div><div layout="" layout-sm="column" class="field"><md-input-container flex=""><label>Username</label> <input type="text" ng-model="vm.user.username"></md-input-container><p class="errors" ng-show="!!errors.username.length"><span ng-repeat="error in errors.username">Username {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field"><md-input-container flex=""><label>Password</label> <input type="password" ng-model="vm.user.password"></md-input-container><p class="errors" ng-show="!!errors.password.length"><span ng-repeat="error in errors.password">Password {{ error }}<span ng-if="!$last">,</span></span></p></div><div layout="" layout-sm="column" class="field"><md-input-container flex=""><label>Email</label> <input type="email" ng-model="vm.user.email"></md-input-container><p class="errors" ng-show="!!errors.email.length"><span ng-repeat="error in errors.email">Email {{ error }}<span ng-if="!$last">,</span></span></p></div></div><md-button class="md-flat md-primary main" ng-click="answer(vm.user)">Sign up</md-button></md-dialog-content><p class="message_below"><span class="message_below_question">Already have an account?</span><md-button class="message_below_link">LOG IN</md-button></p></md-dialog>'),t.put("app/components/userProfile/userProfile.html",'<section class="profile_state"><div class="profile_header" layout="row" layout-align="start center"><md-icon md-svg-src="./assets/images/user_details_icon.svg" class="profile_header_avatar"></md-icon><div class="profile_header_content"><div class="profile_header_name">{{ vm.user.username }}</div><div class="profile_header_location"><md-icon md-svg-src="./assets/images/location_icon.svg" class="profile_header_content_avatar"></md-icon><span>{{ vm.user.location || \'No data\' }}</span></div><div class="profile_header_url"><md-icon md-svg-src="./assets/images/map_icon.svg" class="profile_header_content_avatar"></md-icon><a ng-href="{{ vm.user.url || \'http://example.com\' }}">{{ vm.user.url || \'No data\' }}</a></div></div></div><div class="profile_content" layout="row"><div class="profile_sidebar"><p class="profile_sidebar_title">FILTER KITS BY</p><div class="profile_sidebar_options"><md-button ng-click="vm.filterKits(\'all\')" class="profile_sidebar_button">ALL</md-button><md-button ng-click="vm.filterKits(\'online\')" class="profile_sidebar_button">ONLINE</md-button><md-button ng-click="vm.filterKits(\'offline\')" class="profile_sidebar_button">OFFLINE</md-button></div></div><div class="profile_content_main" flex=""><div class="profile_content_main_top"><span class="profile_content_main_title">{{ vm.filteredKits.length || 0 }} kits filtering by {{ vm.status.toUpperCase() || \'ALL\' }}</span></div><div class="profile_content_main_kits"><div class="kitList_parent" ng-repeat="kit in (vm.filteredKits = (vm.kits | filter: { labels: { status: vm.status } } ))" ng-class="{kitList_borderBottom: $last}"><md-button class="kitList kitList_primary" ng-href="./kits/{{kit.id}}" layout="row" layout-align="start center"><div class="kitList_container" layout="row" layout-align="start center"><div><md-icon class="kitList_avatar" md-svg-src="{{ kit.avatar || \'./assets/images/avatar.svg\' }}"></md-icon></div><div class="kitList_content"><div class="kitList_name">{{ kit.name }}</div><div class="kitList_data"><md-icon class="kitList_icon" md-svg-src="./assets/images/location_icon.svg"></md-icon><span>{{ kit.location }}</span><md-icon class="kitList_icon" md-svg-src="./assets/images/sensor_icon.svg"></md-icon><span>{{ kit.type }}</span></div></div></div></md-button></div><div class="kitList kitList_primary kitList_borderBottom" ng-show="!vm.kits.length"><div class="kitList_container"><div class="kitList_noKits"><span>There are not kits yet</span></div></div></div></div></div></div></section>')
}]);